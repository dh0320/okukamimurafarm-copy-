<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥¥ç¥ä¼ãƒ•ã‚¡ãƒ¼ãƒ  | åœŸã¨ç”Ÿãã‚‹ã€å¾ªç’°ã™ã‚‹æœªæ¥ã€‚</title>
    
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        bg: 'var(--bg)',
                        surface: 'var(--surface)',
                        'surface-2': 'var(--surface-2)',
                        text: 'var(--text)',
                        muted: 'var(--muted)',
                        border: 'var(--border)',
                        primary: 'var(--primary)',
                        'primary-2': 'var(--primary-2)',
                        accent: 'var(--accent)',
                    },
                    fontFamily: {
                        serif: ['Shippori Mincho', 'serif'],
                        sans: ['Noto Sans JP', 'sans-serif'],
                        eng: ['Montserrat', 'sans-serif'],
                    },
                    maxWidth: {
                        'container': '1200px',
                    },
                    animation: {
                        'ken-burns': 'kenBurns 20s ease-out infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        kenBurns: {
                            '0%': { transform: 'scale(1)' },
                            '100%': { transform: 'scale(1.1)' },
                        }
                    }
                }
            }
        }
    </script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Shippori+Mincho:wght@400;500;600;700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">

    <style>
        /* Design Tokens & Theme Variables */
        :root {
            /* Base Colors (Natural Modern) */
            --bg: #FAFAF7;
            --surface: #FFFFFF;
            --surface-2: #F3F4F0;
            --text: #1C1F1D;
            --muted: #5C625E;
            --border: #E6E8E2;
            --primary: #2F6B3E;
            --primary-2: #214E2C;
            --accent: #8A2E2E; /* Horror Accent */
            
            /* Spacing */
            --header-height: 88px;
        }

        /* Phase 2: Slight Unease (Lower contrast, slightly cooler) */
        [data-phase="2"] {
            --bg: #F5F5F0;
            --text: #2C2F2D;
            --muted: #6C726E;
            filter: contrast(0.95) sepia(0.1);
        }

        /* Phase 3: Horror (Darker, Desaturated, Noise-like) */
        [data-phase="3"] {
            --bg: #EAE8E0;
            --text: #111;
            --surface: #F9F7F2;
            --primary: #1A3E24;
            filter: contrast(1.1) grayscale(0.3) brightness(0.9);
        }

        /* Phase 4: Nightmare (Inverted or Dark Mode like) */
        [data-phase="4"] {
            --bg: #0F1210;
            --surface: #1C1F1D;
            --surface-2: #2A2F2B;
            --text: #D1D5DB;
            --muted: #9CA3AF;
            --border: #374151;
            --primary: #8A2E2E; /* Green becomes Blood Red */
            --primary-2: #601818;
            filter: contrast(1.2) grayscale(0.8);
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            transition: background-color 2s ease, color 2s ease, filter 2s ease;
            -webkit-font-smoothing: antialiased;
            line-height: 1.8;
        }

        h1, h2, h3, .font-serif {
            font-family: 'Shippori Mincho', serif;
            letter-spacing: 0.05em;
        }

        /* Utility Animations */
        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-up {
            animation: fadeUp 0.8s ease-out forwards;
        }

        .hover-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .hover-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px -10px rgba(0, 0, 0, 0.1);
        }

        /* Gimmick Specific Styles */
        .hidden-sos::selection {
            background: var(--accent);
            color: white;
        }
        .hidden-sos {
            color: transparent; /* Text matches bg normally via props, but css backup */
        }
        
        /* Lightbox Overlay */
        .lightbox-overlay {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(4px);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: var(--bg);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--muted);
            border-radius: 99px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // --- Data & Assets ---
        // GitHub Raw URL Base
        const BASE_URL = "https://raw.githubusercontent.com/dh0320/okukamimurafarm/f273d82bcc2d0c08371bb0e42d3169c3d36e4b9b";

        const IMAGES = {
            // Top Slideshow
            top_morning: `${BASE_URL}/images/topmorning.png`,
            top_staff: `${BASE_URL}/images/topstaff.png`,
            top_apple: `${BASE_URL}/images/topapple.png`,
            top_children: `${BASE_URL}/images/topchildren.png`,
            top_farm: `${BASE_URL}/images/topfarm.png`,
            
            // Top Horror Changes (Phase 3)
            top_change_village: `${BASE_URL}/images/topchangevillage.png`,
            top_change_stop: `${BASE_URL}/images/topchangestop.png`,

            // Icon (Header)
            icon_default: `${BASE_URL}/images/icondefault.png`,
            icon_change_1: `${BASE_URL}/images/iconchange1.png`,
            icon_change_2: `${BASE_URL}/images/iconchange2.png`,
            icon_change_3: `${BASE_URL}/images/iconchange3.png`,

            // Products
            ec_apple: `${BASE_URL}/images/ecapple.png`,
            ec_applepie: `${BASE_URL}/images/ecapplepie.png`,
            ec_grape: `${BASE_URL}/images/ecgrape.png`,
            ec_jam: `${BASE_URL}/images/ecjam.png`,
            ec_set: `${BASE_URL}/images/ecset.png`,

            // Blog
            blog_sunny: `${BASE_URL}/images/blogsunny.png`,
            blog_applepie: `${BASE_URL}/images/blogapplepie.png`,
            blog_harvest: `${BASE_URL}/images/blogharvest.png`,
            blog_food: `${BASE_URL}/images/blogfood.png`,
            blog_oldbook: `${BASE_URL}/images/blogoldbook.png`,

            // Staff
            staff_manager: `${BASE_URL}/images/staffmanager.png`,
            staff_submanager: `${BASE_URL}/images/staffsubmanager.png`,
            staff_wife: `${BASE_URL}/images/staffwife.png`,
            staff_trainee: `${BASE_URL}/images/stafftrainee.png`,
            staff_victim: `${BASE_URL}/images/staffvictim.png`,
            staff_victim2: `${BASE_URL}/images/staffvictim2.png`,

            // Symbol Tree
            tree_default: `${BASE_URL}/images/treedefault.png`,
            tree_change: `${BASE_URL}/images/treechange.png`,

            // Village
            village_normal: `${BASE_URL}/images/villagenormal.png`,
            village_snow: `${BASE_URL}/images/villagesnow.png`,
            village_night: `${BASE_URL}/images/villagenight.png`,

            // Access (Specified fixed URL)
            access_map: "https://raw.githubusercontent.com/dh0320/okukamimurafarm/main/images/access.png",

            // Video
            victim_movie: `${BASE_URL}/images/victimmovie.mp4`,

            // Recruit (New Image)
            recruiting: "https://raw.githubusercontent.com/dh0320/okukamimurafarm/main/images/recruiting.png"
        };

        // è¨˜äº‹ãƒ‡ãƒ¼ã‚¿
        const BLOG_DATA = [
            {
                id: 4,
                date: "2026.01.18",
                title: "é‡èœã®åç©«",
                desc: "ãƒªãƒ³ã‚´ã ã‘ã§ãªãç¾å‘³ã—ã„é‡èœã‚‚ãŸãã•ã‚“ã¨ã‚Œã¾ã™ï¼ç¥æ§˜ã«æ„Ÿè¬ã§ã™ï¼",
                img: IMAGES.blog_harvest,
                content: `ã€Œå¥¥ç¥ä¼ãƒ•ã‚¡ãƒ¼ãƒ ï¼ã‚Šã‚“ã”ã€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æŒã£ã¦ãã ã•ã‚‹æ–¹ãŒå¤šã„ã®ã§ã™ãŒã€å®Ÿã¯é‡èœã‚‚ãŸãã•ã‚“è‚²ã¦ã¦ã„ã¾ã™ã€‚\nä»Šæ—¥ã¯ã€ç•‘ã®é‡èœã‚’ã¾ã¨ã‚ã¦åç©«ã—ã¾ã—ãŸï¼\n\nåœŸã‹ã‚‰å¼•ãä¸Šã’ãŸç¬é–“ã«åˆ†ã‹ã‚‹ã€æ ¹ã®å¼µã‚Šå…·åˆã€‚\nè‘‰ã®å¼µã‚Šã€è‰²ã€é¦™ã‚Šã€‚\næ‰‹ã«å–ã‚‹ã ã‘ã§ã€Œã‚ˆãè‚²ã£ã¦ãã‚ŒãŸãªã‚ã€ã¨æ€ãˆã‚‹ç¬é–“ãŒã‚ã£ã¦ã€ã“ã‚ŒãŒç•‘ã®ä»•äº‹ã®é†é†å‘³ã§ã™ã€‚\n\nåç©«ã§ããŸã®ã¯ã€\nãƒ»ã¿ãšã¿ãšã—ã„è‘‰ç‰©\nãƒ»ç”˜ã¿ã®ã®ã£ãŸæ ¹èœ\nãƒ»æ–™ç†ãŒæ¥½ã—ããªã‚‹ãƒãƒ¼ãƒ–\nãªã©ã€é£Ÿå“ãŒãã£ã¨è±Šã‹ã«ãªã‚‹ã‚‚ã®ã°ã‹ã‚Šã€‚\n\nè‡ªç„¶ç›¸æ‰‹ã®ä»•äº‹ãªã®ã§ã€ã†ã¾ãã„ã‹ãªã„æ—¥ã‚‚ã‚ã‚Šã¾ã™ã€‚\nãã‚Œã§ã‚‚ã€å¤ªé™½ã¨é›¨ã¨åœŸã€ãã—ã¦äººã®æ‰‹ãŒãã‚ã£ã¦ã€Œå®Ÿã‚Šã€ã«ãªã£ãŸã¨ãã¯ã€ã‚„ã£ã±ã‚Šèƒ¸ãŒã„ã£ã±ã„ã«ãªã‚Šã¾ã™ã€‚ç¥æ§˜ã«æ„Ÿè¬ã§ã™ã€‚\n\nã“ã‚Œã‹ã‚‰ã‚‚ã€æœå®Ÿã‚‚é‡èœã‚‚ã€å¥¥ç¥ä¼ã®å­£ç¯€ã‚’ãã®ã¾ã¾æ„Ÿã˜ã‚‰ã‚Œã‚‹å‘³ã‚’ãŠå±Šã‘ã§ãã‚‹ã‚ˆã†ã€ä¸å¯§ã«è‚²ã¦ã¦ã„ãã¾ã™ã€‚\nåç©«ã®æ§˜å­ã¯å†™çœŸã§ã‚‚ãŸã£ã·ã‚Šæ²è¼‰ã—ã¾ã™ã®ã§ã€ãœã²ã®ãã„ã¦ãã ã•ã„ã­ã€‚`
            },
            {
                id: 3,
                date: "2026.01.10",
                title: "æ‘ã®å­ä¾›é”ã¨ã‚¢ãƒƒãƒ—ãƒ«ãƒ‘ã‚¤ä½œã‚Šä½“é¨“ï¼",
                desc: "å­ä¾›é”ã¨ã®ãƒ‘ã‚¤ä½œã‚Šï¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ãŠç­”ãˆã—ã¦ãƒ¬ã‚·ãƒ”ã‚‚æ²è¼‰ã—ã¾ã™ã­ï¼",
                img: IMAGES.blog_applepie,
                isRecipe: true, // ã‚®ãƒŸãƒƒã‚¯ç”¨ãƒ•ãƒ©ã‚°
                content: `å…ˆæ—¥ã€æ‘ã®å­ã©ã‚‚ãŸã¡ã¨ä¸€ç·’ã«ã‚¢ãƒƒãƒ—ãƒ«ãƒ‘ã‚¤ä½œã‚Šä½“é¨“ã‚’ã—ã¾ã—ãŸã€‚\nã‚¨ãƒ—ãƒ­ãƒ³å§¿ã§é›†ã¾ã£ã¦ãã‚‹ã ã‘ã§ã€ã‚­ãƒƒãƒãƒ³ãŒä¸€æ°—ã«ã«ãã‚„ã‹ã«ã€‚ã‚Šã‚“ã”ã‚’åˆ‡ã‚‹éŸ³ã€ç¬‘ã„å£°ã€ç”˜ã„é¦™ã‚Šâ€¦ã“ã®æ™‚é–“ã ã‘ã§ã€Œã‚„ã£ã¦ã‚ˆã‹ã£ãŸãªã‚ã€ã¨æ€ãˆã¾ã™ã€‚\n\nä»Šå›ä½¿ã£ãŸã‚Šã‚“ã”ã¯ã€ã—ã£ã‹ã‚Šç”˜ã¿ãŒã®ã£ãŸã‚‚ã®ã‚’é¸ã‚“ã§ã€ã‚·ãƒŠãƒ¢ãƒ³ã¯æ§ãˆã‚ã«ã€‚\nå°ã•ãªæ‰‹ã§ã‚‚æ‰±ã„ã‚„ã™ã„ã‚ˆã†ã«ã€ã‚Šã‚“ã”ã¯å°‘ã—è–„ã‚ã«ã‚«ãƒƒãƒˆã—ã¦ã€ç«å…¥ã‚Œã‚‚çŸ­æ™‚é–“ã§ä»•ä¸Šã’ã¾ã—ãŸã€‚\n\nç„¼ãã‚ãŒã£ãŸãƒ‘ã‚¤ã‚’ã‚ªãƒ¼ãƒ–ãƒ³ã‹ã‚‰å‡ºã—ãŸç¬é–“ã€\nã€Œã‚ã‚ã€œï¼ã€ã£ã¦å£°ãŒæƒã†ã®ãŒæœ€é«˜ã§ã™ã€‚\nè¡¨é¢ãŒã“ã‚“ãŒã‚Šè‰²ã¥ã„ã¦ã€ãµã‚ã£ã¨ç«‹ã¤é¦™ã‚ŠãŒãŸã¾ã‚Šã¾ã›ã‚“ã€‚\n\nã€ŒãŠã†ã¡ã§ã‚‚ä½œã‚ŠãŸã„ï¼ã€ã¨ã„ã†å£°ãŒå¤šã‹ã£ãŸã®ã§ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ãŠå¿œãˆã—ã¦ãƒ¬ã‚·ãƒ”ã‚‚ã¾ã¨ã‚ã¾ã—ãŸã€‚\nä¸‹ã®ãƒªãƒ³ã‚¯ã‹ã‚‰ã”è¦§ã„ãŸã ã‘ã¾ã™ğŸ‘‡\n\næœ€å¾Œã«ã€å‚åŠ ã—ã¦ãã‚ŒãŸã¿ã‚“ãªã¸ã€‚\nåŒ…ä¸ã‚’æŒã¤æ‰‹ã‚‚ã€ãƒ‘ã‚¤ç”Ÿåœ°ã‚’ä¼¸ã°ã™æ‰‹ã‚‚ã€ã¨ã£ã¦ã‚‚çœŸå‰£ã§ç´ æ•µã§ã—ãŸã€‚\nã¾ãŸå­£ç¯€ãŒå¤‰ã‚ã£ãŸã‚‰ã€åˆ¥ã®ãŠè“å­ã§ã‚‚ä¸€ç·’ã«ä½œã‚ã†ã­ã€‚`
            },
            {
                id: 2,
                date: "2026.01.05",
                title: "ã¿ã‚“ãªã§ã”é£¯ä½œã‚Š",
                desc: "è¾²åœ’ã®ã¿ã‚“ãªã§ãƒ©ãƒ³ãƒã«é‡èœãŸãã•ã‚“ã®ãƒ”ã‚¶ã‚’ä½œã‚Šã¾ã—ãŸï¼",
                img: IMAGES.blog_food,
                content: `ä»Šæ—¥ã¯å°‘ã—æ‰‹ãŒç©ºã„ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã€è¾²åœ’ã®ã¿ã‚“ãªã§ãƒ©ãƒ³ãƒä½œã‚Šã€‚\nã€Œã›ã£ã‹ãã ã—ã€ç•‘ã®é‡èœã‚’æ€ã„ã£ãã‚Šä½¿ãŠã†ï¼ã€ã¨ã„ã†ã“ã¨ã§ã€é‡èœãŸã£ã·ã‚Šã®ãƒ”ã‚¶ã‚’ç„¼ãã¾ã—ãŸğŸ•ğŸ¥¬\n\nç•‘ã‹ã‚‰æ¡ã£ã¦ããŸã®ã¯ã€\nã‚ºãƒƒã‚­ãƒ¼ãƒ‹ã€ç‰ã­ãã€ã»ã†ã‚Œã‚“è‰ã€ãƒŸãƒ‹ãƒˆãƒãƒˆã€ãã—ã¦é¦™ã‚Šã®è‰¯ã„ãƒãƒ¼ãƒ–ã€‚\nåˆ‡ã£ã¦ä¸¦ã¹ã‚‹ã ã‘ã§ã‚‚è‰²ãŒãã‚Œã„ã§ã€ã‚­ãƒƒãƒãƒ³ãŒä¸€æ°—ã«å…ƒæ°—ã«ãªã‚Šã¾ã™ã€‚\n\nãƒ”ã‚¶ä½œã‚Šã£ã¦ã€å®Ÿã¯è¾²åœ’ã®ä»•äº‹ã«ã¡ã‚‡ã£ã¨ä¼¼ã¦ã„ã¦ã€‚\nã€Œã©ã‚Œã‚’ã€ã©ã®é †ç•ªã§ã€ã©ã†ä¸¦ã¹ãŸã‚‰ä¸€ç•ªãŠã„ã—ããªã‚‹ã‹ã€\nã¿ã‚“ãªã§ç›¸è«‡ã—ãªãŒã‚‰æ‰‹ã‚’å‹•ã‹ã—ã¦ã„ã‚‹æ™‚é–“ãŒã€ã™ã”ãæ¥½ã—ã„ã‚“ã§ã™ã€‚\n\nç„¼ãä¸ŠãŒã‚Šã¯ã€å¤–ã¯ã‚«ãƒªãƒƒã¨ä¸­ã¯ã‚‚ã¡ã£ã¨ã€‚\né‡èœãŒã˜ã‚…ã‚ã£ã¨ç”˜ãã¦ã€æ€ã‚ãšç„¡è¨€ã«ãªã‚‹ãŠã„ã—ã•ã§ã—ãŸã€‚\nï¼ˆæ°—ã¥ã„ãŸã‚‰ä¸€æšç›®ãŒä¸€ç¬ã§æ¶ˆãˆã¦ã¾ã—ãŸâ€¦ç¬‘ï¼‰\n\nè¾²åœ’ã®æ—¥å¸¸ã¯æ´¾æ‰‹ã˜ã‚ƒãªã„ã‘ã‚Œã©ã€ã“ã†ã„ã†å°ã•ãªâ€œã”è¤’ç¾â€ãŒã‚ã‚‹ã¨ã€åˆå¾Œã®ä½œæ¥­ã‚‚é ‘å¼µã‚Œã¾ã™ã€‚\nã¾ãŸå­£ç¯€ã®é‡èœã§ã€åˆ¥ã®ãƒ”ã‚¶ã‚‚è©¦ã—ã¦ã¿ãŸã„ã§ã™ã­ã€‚`
            },
            {
                id: 1,
                date: "2026.01.01",
                title: "æ–°å¹´ã®ã”æŒ¨æ‹¶",
                desc: "æœ¬å¹´ã‚‚å¥¥ç¥ä¼ãƒ•ã‚¡ãƒ¼ãƒ ã‚’ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚",
                img: IMAGES.blog_sunny,
                content: `ã‚ã‘ã¾ã—ã¦ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ã€‚å¥¥ç¥ä¼ãƒ•ã‚¡ãƒ¼ãƒ ã§ã™ã€‚\næ—§å¹´ä¸­ã¯ã€ç§ãŸã¡ã®è¾²åœ’ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã‚Šã€æ¸©ã‹ã„è¨€è‘‰ã‚„å¿œæ´ã‚’ãŸãã•ã‚“ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚\n\nå†¬ã®å¥¥ç¥ä¼ã¯ã€ç©ºæ°—ãŒãã‚Šã£ã¨æ¾„ã‚“ã§ã„ã¦ã€æœã¯ç•‘ãŒç™½ããµã‚ã£ã¨éœœã§è¦†ã‚ã‚Œã¾ã™ã€‚åç©«ã®ã«ãã‚„ã‹ã•ãŒè½ã¡ç€ã„ãŸã“ã®å­£ç¯€ã¯ã€æ¥ã‚‹æ˜¥ã®ãŸã‚ã®â€œä»•è¾¼ã¿â€ã®æ™‚æœŸã€‚æœæ¨¹ã®æ‰‹å…¥ã‚Œã‚„åœŸã¥ãã‚Šã€ä»Šå¹´ã®ç•‘ã®è¨ˆç”»ã‚’ç«‹ã¦ãªãŒã‚‰ã€å°‘ã—ãšã¤æ¬¡ã®å­£ç¯€ã¸å‘ã‘ã¦æ•´ãˆã¦ã„ãã¾ã™ã€‚\n\nä»Šå¹´ã‚‚ã€\nãƒ»æ—¬ã®æœå®Ÿã‚„é‡èœã®ã“ã¨\nãƒ»åç©«ã‚„åŠ å·¥ã®è£å´\nãƒ»ä½“é¨“ã‚¤ãƒ™ãƒ³ãƒˆã®æ§˜å­\nãƒ»æ‘ã®å››å­£ã®é¢¨æ™¯\nã‚’ã€å†™çœŸã¨ä¸€ç·’ã«æ—¥èªŒã§ã“ã¾ã‚ã«ãŠå±Šã‘ã—ã¦ã„ãäºˆå®šã§ã™ã€‚\n\nã€Œã“ã“ã«æ¥ã‚‹ã¨ã€ãªã‚“ã ã‹å‘¼å¸ãŒæ·±ããªã‚‹ã€\nãã‚“ãªå ´æ‰€ã§ã‚ã‚Šç¶šã‘ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã€å®¶æ—ã¨ã‚¹ã‚¿ãƒƒãƒ•ã¿ã‚“ãªã§ä¸å¯§ã«è‚²ã¦ã¦ã„ãã¾ã™ã€‚\n\næœ¬å¹´ã‚‚å¥¥ç¥ä¼ãƒ•ã‚¡ãƒ¼ãƒ ã‚’ã€ã©ã†ãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚\nå¥¥ç¥ä¼ãƒ•ã‚¡ãƒ¼ãƒ ä¸€åŒ`
            }
        ];

        // ã‚¹ã‚¿ãƒƒãƒ•è©³ç´°ãƒ‡ãƒ¼ã‚¿
        const STAFF_DATA = [
            {
                id: 'tome',
                name: 'ç¥å» ãƒˆãƒ¡',
                role: 'PROCESSOR',
                role_jp: 'åŠ å·¥å“ãƒ»è¾²åœ’ã‚­ãƒƒãƒãƒ³æ‹…å½“',
                image: IMAGES.staff_wife,
                short_intro: 'å­£ç¯€ã®æ‰‹ã—ã”ã¨ã§ã€ã‚„ã•ã—ã„å‘³ã‚’å±Šã‘ã¾ã™', 
                intro: `å¥¥ç¥ä¼è¾²åœ’ã§åŠ å·¥å“ã¥ãã‚Šã¨è¾²åœ’ã‚­ãƒƒãƒãƒ³ã‚’æ‹…å½“ã—ã¦ã„ã‚‹ã€ç¥å»ãƒˆãƒ¡ã§ã™ã€‚åç©«ã—ãŸæœå®Ÿã®é¦™ã‚Šã‚„ç”˜ã¿ã‚’å¤§åˆ‡ã«ã—ãªãŒã‚‰ã€ã‚¸ãƒ£ãƒ ã‚„ç„¼ãè“å­ã€å­£ç¯€ã®ä¿å­˜é£Ÿã‚’æ‰‹ä»•äº‹ã§ä»•è¾¼ã‚“ã§ã„ã¾ã™ã€‚ãŠè¶Šã—ã„ãŸã ã„ãŸæ–¹ãŒã»ã£ã¨ã§ãã‚‹ã‚ˆã†ãªã€ç´ æœ´ã§ã‚„ã•ã—ã„å‘³ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚`,
                reason: `å®¶æ—ã®å–¶ã‚€è¾²åœ’ã®æ‰‹ä¼ã„ã‚’ã—ã¦ã„ãä¸­ã§ã€ã€Œæ¡ã‚ŒãŸã¦ã‚’ãã®ã¾ã¾å±Šã‘ã‚‹ã ã‘ã§ãªãã€å­£ç¯€ã®æµã¿ã‚’ä¸€å¹´ä¸­æ¥½ã—ã‚ã‚‹å½¢ã«ã—ãŸã„ã€ã¨æ€ã†ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚æ˜”ã‹ã‚‰å®¶ã§ä½œã£ã¦ã„ãŸä¿å­˜é£Ÿã‚„ãŠè“å­ã‚’ã€å°‘ã—ãšã¤è¾²åœ’ã®â€œé¡”â€ã¨ã—ã¦ãŠå±Šã‘ã™ã‚‹ã‚ˆã†ã«ãªã£ãŸã®ãŒå§‹ã¾ã‚Šã§ã™ã€‚`,
                joy: `å®Œç†Ÿã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¦‹æ¥µã‚ã¦ä»•è¾¼ã‚“ã åŠ å·¥å“ãŒã€ã€Œã¾ãŸé£Ÿã¹ãŸã„ã€ã¨è¨€ã£ã¦ã‚‚ã‚‰ãˆãŸæ™‚ãŒä¸€ç•ªã†ã‚Œã—ã„ã§ã™ã€‚è¦æ ¼å¤–ã®æœå®Ÿã‚‚ç„¡é§„ã«ã›ãšã€ãŠã„ã—ã•ã«å¤‰ãˆã¦ã„ã‘ã‚‹ã®ã‚‚ã‚„ã‚ŠãŒã„ã§ã™ã­ã€‚å­£ç¯€ã”ã¨ã«é¦™ã‚Šã‚„æ°´åˆ†é‡ãŒå¤‰ã‚ã‚‹ã®ã§ã€æ¯å¹´åŒã˜ã‚ˆã†ã§åŒã˜ã«ãªã‚‰ãªã„ã¨ã“ã‚ã‚‚é¢ç™½ã„ã¨æ„Ÿã˜ã¦ã„ã¾ã™ã€‚`
            },
            {
                id: 'sato',
                name: 'ä½è—¤ å¥å¤ª',
                role: 'WEB MANAGER',
                role_jp: 'å‰¯åœ’é•·ãƒ»Web/åºƒå ±ãƒ»ä½“é¨“é‹å–¶',
                image: IMAGES.staff_submanager,
                short_intro: 'è¾²æ¥­ã‚’æ¥½ã—ã¿ãªãŒã‚‰ã€ç•‘ã‚„å¥¥ç¥ä¼æ‘ã®é­…åŠ›ã‚’ä¼ãˆã¾ã™', 
                intro: `å‰¯åœ’é•·ã®ä½è—¤å¥å¤ªã§ã™ã€‚è¾²åœ’ã®é‹å–¶ã‚µãƒãƒ¼ãƒˆã«åŠ ãˆã¦ã€Webã‚µã‚¤ãƒˆã‚„ãŠå•ã„åˆã‚ã›å¯¾å¿œã€ä½“é¨“ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã”æ¡ˆå†…ãªã©ã€Œå¤–ã¨è¾²åœ’ã‚’ã¤ãªãå½¹å‰²ã€ã‚’æ‹…å½“ã—ã¦ã„ã¾ã™ã€‚ç•‘ã®ä»•äº‹ã‚‚è¦šãˆãªãŒã‚‰ã€å†™çœŸæ’®å½±ã‚„æ–‡ç« ã¥ãã‚Šã§å¥¥ç¥ä¼ã®é­…åŠ›ãŒä¼ã‚ã‚‹ã‚ˆã†æ—¥ã€…å·¥å¤«ã—ã¦ã„ã¾ã™ã€‚`,
                reason: `ä»¥å‰ã¯è¡—ã§åƒã„ã¦ã„ã¾ã—ãŸãŒã€åˆã‚ã¦å¥¥ç¥ä¼ã‚’è¨ªã‚ŒãŸã¨ãã«ã€ç©ºæ°—ã‚„æ°´ã®ãã‚Œã„ã•ã€å­£ç¯€ã®ç§»ã‚ã„ã®æ¿ƒã•ã«æƒ¹ã‹ã‚Œã¾ã—ãŸã€‚è¾²åœ’ã®ä»•äº‹ã‚’çŸ¥ã‚‹ã»ã©ã«ã€ä½œã‚‹äººã®é¡”ãŒè¦‹ãˆã‚‹ã‚‚ã®ã‚’ä¸å¯§ã«å±Šã‘ãŸã„ã¨æ€ã„ã€ç§»ä½ã—ã¦ã“ã®è¾²åœ’ã«åŠ ã‚ã‚Šã¾ã—ãŸã€‚`,
                joy: `ãŠå®¢æ§˜ã®ã€Œã‚µã‚¤ãƒˆã‚’è¦‹ã¦æ¥ã¾ã—ãŸã€ã€Œæ—¥èªŒã‚’èª­ã‚“ã§å®‰å¿ƒã—ã¾ã—ãŸã€ã¨ã„ã†ä¸€è¨€ãŒã€ã™ã”ãåŠ±ã¿ã«ãªã‚Šã¾ã™ã€‚ç•‘ã§ã®ä½œæ¥­ãŒãã®ã¾ã¾å•†å“ã‚„ä½“é¨“ã«ã¤ãªãŒã‚Šã€åå¿œãŒè¿”ã£ã¦ãã‚‹ã®ãŒé¢ç™½ã„ã§ã™ã­ã€‚å°ã•ãªæ”¹å–„ã‚’ç©ã¿é‡ã­ã¦ã€è¾²åœ’å…¨ä½“ãŒå°‘ã—ãšã¤è‰¯ããªã£ã¦ã„ãæ„Ÿè¦šã«ã‚„ã‚ŠãŒã„ã‚’æ„Ÿã˜ã¦ã„ã¾ã™ã€‚`,
                hidden: "ã“ã®æ‘ã¯ç‹‚ã£ã¦ã‚‹ã€‚å‡ºã‚‰ã‚Œãªã„ã€‚åŠ©ã‘ã¦ãã‚Œã€‚" // F01ç”¨
            },
            {
                id: 'lin',
                name: 'ã‚°ã‚¨ãƒ³ãƒ»ãƒã‚¤ãƒ»ãƒªãƒ³',
                role: 'TRAINEE',
                role_jp: 'æŠ€èƒ½å®Ÿç¿’ç”Ÿä»£è¡¨ãƒ»æ ½åŸ¹ãƒãƒ¼ãƒ ',
                image: IMAGES.staff_trainee,
                short_intro: 'å››å­£ã®ä»•äº‹ã‚’å­¦ã³ã€ä¸å¯§ãªæ ½åŸ¹ã‚’æ”¯ãˆã¾ã™', 
                intro: `æŠ€èƒ½å®Ÿç¿’ç”Ÿä»£è¡¨ã®ã‚°ã‚¨ãƒ³ãƒ»ãƒã‚¤ãƒ»ãƒªãƒ³ã§ã™ã€‚æ ½åŸ¹ãƒãƒ¼ãƒ ã§ä½œæ¥­ã‚’ã—ãªãŒã‚‰ã€å®Ÿç¿’ç”Ÿã®ã¿ã‚“ãªãŒåƒãã‚„ã™ã„ã‚ˆã†ã«å£°ã‚’ã‹ã‘ãŸã‚Šã€å›°ã£ãŸã“ã¨ãŒã‚ã£ãŸæ™‚ã«ç›¸è«‡ã‚’ã¾ã¨ã‚ãŸã‚Šã—ã¦ã„ã¾ã™ã€‚æ—¥æœ¬ã®è¾²æ¥­ã®æŠ€è¡“ã¨ã€å¥¥ç¥ä¼ã®å››å­£ã®ä»•äº‹ã‚’å­¦ã¹ã‚‹æ¯æ—¥ãŒæ–°é®®ã§ã™ã€‚`,
                reason: `æœæ¨¹æ ½åŸ¹ã‚„åŠ å·¥ã¾ã§ä¸€è²«ã—ã¦å­¦ã¹ã‚‹ç’°å¢ƒã«é­…åŠ›ã‚’æ„Ÿã˜ã€ã“ã®è¾²åœ’ã§å®Ÿç¿’ã‚’ã—ãŸã„ã¨æ€ã„ã¾ã—ãŸã€‚å±±ã«å›²ã¾ã‚ŒãŸå ´æ‰€ã§ã€å­£ç¯€ã®å¤‰åŒ–ã‚’è¿‘ãã§æ„Ÿã˜ãªãŒã‚‰åƒã‘ã‚‹ã“ã¨ã«ã‚‚æƒ¹ã‹ã‚Œã¾ã—ãŸã€‚æ¥æ—¥ã—ã¦ã‹ã‚‰ã¯ã€æ—¥æœ¬èªã¨ä½œæ¥­ã®ä¸¡æ–¹ã‚’å°‘ã—ãšã¤èº«ã«ã¤ã‘ã¦ã„ã¾ã™ã€‚`,
                joy: `å‰ªå®šã‚„æ‰‹å…¥ã‚Œã‚’ã—ãŸæœ¨ãŒã€å­£ç¯€ã‚’è¶Šãˆã¦å®Ÿã‚’ã¤ã‘ã‚‹ç¬é–“ã‚’è¦‹ã‚‹ã¨ã€ã¨ã¦ã‚‚é”æˆæ„ŸãŒã‚ã‚Šã¾ã™ã€‚åç©«ã—ãŸæœå®ŸãŒå•†å“ã«ãªã‚Šã€ã€ŒãŠã„ã—ã„ã€ã¨è¨€ã£ã¦ã‚‚ã‚‰ãˆã‚‹ã¨èª‡ã‚‰ã—ã„æ°—æŒã¡ã«ãªã‚Šã¾ã™ã€‚ä»£è¡¨ã¨ã—ã¦ã¯ã€ã¿ã‚“ãªãŒå®‰å¿ƒã—ã¦å­¦ã¹ã‚‹ã‚ˆã†ã«ã€ä½œæ¥­ã‚„ç”Ÿæ´»ã®ã“ã¨ã‚’å°ã•ãªã“ã¨ã§ã‚‚å…±æœ‰ã§ãã‚‹é›°å›²æ°—ã¥ãã‚Šã‚’å¤§åˆ‡ã«ã—ã¦ã„ã¾ã™ã€‚`
            }
        ];

        const MAX_FLAGS = 13;

        // --- Common Components ---

        const SectionTitle = ({ title, sub, align = "center" }) => (
            <div className={`mb-12 md:mb-20 text-${align} animate-fade-up`}>
                <p className="text-primary font-eng text-sm tracking-widest font-semibold mb-3 uppercase">{sub}</p>
                <h2 className="text-3xl md:text-4xl font-serif text-text leading-tight">{title}</h2>
            </div>
        );

        const Button = ({ children, onClick, variant = "primary", className = "", type = "button" }) => {
            const baseClass = "inline-flex items-center justify-center px-8 py-3 rounded-full transition-all duration-300 font-medium tracking-wide text-sm";
            const variants = {
                primary: "bg-primary text-white hover:bg-primary-2 shadow-lg hover:shadow-xl",
                secondary: "border border-text text-text hover:bg-text hover:text-white",
                ghost: "text-text hover:text-primary underline-offset-4 hover:underline",
            };
            return (
                <button type={type} onClick={onClick} className={`${baseClass} ${variants[variant]} ${className}`}>
                    {children}
                </button>
            );
        };

        // Advertisement Placeholder
        const AdSpace = ({ className = "" }) => (
            <div className={`w-full max-w-container mx-auto px-6 my-16 animate-fade-up ${className}`}>
                <div className="bg-gray-100 border border-gray-200 w-full min-h-[200px] md:min-h-[250px] flex flex-col items-center justify-center text-muted relative overflow-hidden">
                    <div className="absolute top-2 right-2 text-[10px] border border-muted px-1">åºƒå‘Š</div>
                    <div className="text-center">
                        <p className="font-bold text-gray-400 text-lg">åºƒå‘Šæ²è¼‰äºˆå®šã‚¨ãƒªã‚¢</p>
                        <p className="text-xs mt-2 text-gray-400">Google Adsense / Display Ads</p>
                    </div>
                    <div className="absolute inset-0 opacity-5 pointer-events-none" style={{ backgroundImage: 'radial-gradient(#000 1px, transparent 1px)', backgroundSize: '20px 20px' }}></div>
                </div>
            </div>
        );

        // --- Layout Components ---

        const Header = ({ setPage, currentPage, phase }) => {
            const [isScrolled, setIsScrolled] = useState(false);
            const [isMenuOpen, setIsMenuOpen] = useState(false);

            useEffect(() => {
                const handleScroll = () => setIsScrolled(window.scrollY > 50);
                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);

            const getIcon = () => {
                if (phase >= 4) return IMAGES.icon_change_3;
                if (phase >= 3) return IMAGES.icon_change_2;
                if (phase >= 2) return IMAGES.icon_change_1;
                return IMAGES.icon_default;
            };

            const menuItems = [
                { id: 'home', label: 'HOME' },
                { id: 'about', label: 'ABOUT' },
                { id: 'village', label: 'VILLAGE' },
                { id: 'products', label: 'PRODUCTS' },
                { id: 'diary', label: 'DIARY' },
                { id: 'access', label: 'ACCESS' },
                { id: 'recruit', label: 'RECRUIT' },
            ];

            return (
                <>
                    <header 
                        className={`fixed top-0 w-full z-50 transition-all duration-500 ${
                            isScrolled || isMenuOpen ? 'bg-white/95 backdrop-blur-md shadow-sm text-text' : 'bg-gradient-to-b from-black/60 to-transparent text-white'
                        }`}
                        style={{ height: 'var(--header-height)' }}
                    >
                        <div className="max-w-container mx-auto px-4 md:px-8 h-full flex items-center justify-between">
                            <div className="flex items-center gap-4 cursor-pointer z-50" onClick={() => { setPage('home'); setIsMenuOpen(false); }}>
                                <div className="w-16 h-16 rounded-full overflow-hidden shadow-md transition-transform duration-500 hover:scale-105 flex items-center justify-center bg-transparent">
                                    <img src={getIcon()} alt="Logo" className="w-full h-full object-cover scale-150 transform" />
                                </div>
                                <span className={`text-xl font-serif font-bold tracking-widest ${phase >= 4 ? 'text-accent' : (isScrolled ? 'text-text' : 'text-white drop-shadow-md')}`}>
                                    å¥¥ç¥ä¼ãƒ•ã‚¡ãƒ¼ãƒ 
                                </span>
                            </div>

                            <nav className="hidden lg:flex items-center gap-8">
                                {menuItems.map(item => (
                                    <button 
                                        key={item.id}
                                        onClick={() => setPage(item.id)}
                                        className={`text-sm font-eng tracking-wider hover:text-primary transition-colors ${currentPage === item.id ? 'font-bold' : ''} ${isScrolled ? 'text-text' : 'text-white drop-shadow-sm'}`}
                                    >
                                        {item.label}
                                    </button>
                                ))}
                                <Button onClick={() => setPage('contact')} className={`ml-4 ${isScrolled ? '' : 'bg-white/20 hover:bg-white/40 border-white text-white backdrop-blur-sm'}`}>ãŠå•ã„åˆã‚ã›</Button>
                            </nav>

                            <button className={`lg:hidden z-50 p-2 ${isScrolled ? 'text-text' : 'text-white'}`} onClick={() => setIsMenuOpen(!isMenuOpen)}>
                                {isMenuOpen ? <i data-lucide="x" className="w-6 h-6"></i> : <i data-lucide="menu" className="w-6 h-6"></i>}
                            </button>
                        </div>
                    </header>

                    <div className={`fixed inset-0 bg-white/95 backdrop-blur-xl z-40 transition-transform duration-500 flex flex-col justify-center items-center gap-8 ${isMenuOpen ? 'translate-y-0' : '-translate-y-full'}`}>
                        {menuItems.map(item => (
                            <button 
                                key={item.id}
                                onClick={() => { setPage(item.id); setIsMenuOpen(false); }}
                                className="text-2xl font-serif font-medium text-text hover:text-primary transition-colors"
                            >
                                {item.label}
                            </button>
                        ))}
                        <Button onClick={() => { setPage('contact'); setIsMenuOpen(false); }} className="mt-4">ãŠå•ã„åˆã‚ã›</Button>
                    </div>
                </>
            );
        };

        const Footer = ({ phase, setPage }) => {
            return (
                <footer className={`pt-20 pb-8 px-6 transition-colors duration-1000 ${phase >= 4 ? 'bg-black text-accent' : 'bg-primary text-white'}`}>
                    <div className="max-w-container mx-auto grid grid-cols-1 md:grid-cols-4 gap-12 mb-16">
                        <div className="md:col-span-1">
                            <h2 className="text-2xl font-serif font-bold mb-6 tracking-widest">å¥¥ç¥ä¼ãƒ•ã‚¡ãƒ¼ãƒ </h2>
                            <p className="text-sm opacity-80 leading-relaxed font-sans">
                                ã€’399-0000<br/>
                                é•·é‡çœŒå¥¥ç¥ä¼æ‘å­—è›‡å–° 1092<br/>
                                TEL: 026-000-0000
                            </p>
                        </div>
                        <div className="md:col-span-2 grid grid-cols-2 gap-8 text-sm">
                            <div className="flex flex-col gap-3">
                                <span onClick={() => setPage('about')} className="cursor-pointer hover:opacity-70">è¾²åœ’ã«ã¤ã„ã¦</span>
                                <span onClick={() => setPage('village')} className="cursor-pointer hover:opacity-70">å¥¥ç¥ä¼æ‘</span>
                                <span onClick={() => setPage('products')} className="cursor-pointer hover:opacity-70">å•†å“ä¸€è¦§</span>
                            </div>
                            <div className="flex flex-col gap-3">
                                <span onClick={() => setPage('diary')} className="cursor-pointer hover:opacity-70">æ´»å‹•æ—¥èªŒ</span>
                                <span onClick={() => setPage('access')} className="cursor-pointer hover:opacity-70">ã‚¢ã‚¯ã‚»ã‚¹</span>
                                <span onClick={() => setPage('recruit')} className="cursor-pointer hover:opacity-70">æ¡ç”¨æƒ…å ±</span>
                            </div>
                        </div>
                        <div className="md:col-span-1">
                            <Button variant="secondary" className="w-full border-white text-white hover:bg-white hover:text-primary mb-6" onClick={() => setPage('contact')}>
                                ãŠå•ã„åˆã‚ã›
                            </Button>
                            <div className="flex gap-4 justify-center md:justify-start opacity-80">
                                <span>Instagram</span>
                                <span>Facebook</span>
                            </div>
                        </div>
                    </div>
                    <div className="border-t border-white/20 pt-8 text-center text-xs opacity-60 font-eng tracking-wider">
                        <p>Â© 
                            <span title={phase >= 3 ? "1826" : "2026"} className="mx-1 hover:text-red-500 cursor-default transition-colors">
                                {phase >= 3 ? "1826" : "2026"}
                            </span> 
                            Okukamifushi Farm. All Rights Reserved.
                        </p>
                    </div>
                </footer>
            );
        };

        // --- Pages ---

        // 1. HOME
        const Home = ({ phase, unlockFlag, flags, setPage }) => {
            const [currentSlide, setCurrentSlide] = useState(0);

            const slides = useMemo(() => {
                let baseSlides = [
                    IMAGES.top_morning,
                    IMAGES.top_staff,
                    IMAGES.top_apple,
                    IMAGES.top_children,
                    IMAGES.top_farm
                ];
                if (phase >= 3) {
                    baseSlides[3] = IMAGES.top_change_village;
                    baseSlides[4] = IMAGES.top_change_stop;
                }
                return baseSlides;
            }, [phase]);

            useEffect(() => {
                const slideInterval = setInterval(() => {
                    setCurrentSlide((prev) => (prev + 1) % slides.length);
                }, 6000); 
                return () => clearInterval(slideInterval);
            }, [slides.length]);

            return (
                <>
                    <div className="relative h-[75vh] min-h-[550px] w-full overflow-hidden bg-black">
                        {slides.map((img, index) => (
                            <div 
                                key={index}
                                className={`absolute inset-0 bg-cover bg-center transition-opacity duration-[2000ms] ease-in-out ${currentSlide === index ? 'opacity-100 z-10' : 'opacity-0 z-0'}`}
                                style={{ backgroundImage: `url(${img})` }}
                            >
                                <div className={`absolute inset-0 bg-cover bg-center ${currentSlide === index ? 'scale-110 transition-transform duration-[10000ms] ease-out' : 'scale-100'}`} style={{ backgroundImage: `url(${img})` }}></div>
                            </div>
                        ))}

                        {phase >= 3 && (currentSlide === 3 || currentSlide === 4) && (
                            <div 
                                className="absolute inset-0 z-20 cursor-pointer"
                                onClick={() => {
                                    if (!flags.F08) {
                                        alert("ã€F08: ç•°æ§˜ãªå…‰æ™¯ã€‘\næ‘ã®å‡ºå£ãŒå°é–ã•ã‚Œã€æ‘äººãŸã¡ãŒã“ã¡ã‚‰ã‚’ç›£è¦–ã—ã¦ã„ã‚‹å¹»è¦šãŒè¦‹ãˆãŸã€‚");
                                        unlockFlag('F08');
                                    }
                                }}
                            />
                        )}

                        <div className="absolute inset-0 bg-black/30 flex items-center justify-center p-6 z-30">
                            <div className="text-center text-white animate-fade-up">
                                <p className="text-sm md:text-base font-eng tracking-[0.2em] mb-4 uppercase drop-shadow-md">Organic Farm in Okukamifushi</p>
                                <h1 className="text-4xl md:text-6xl lg:text-7xl font-serif font-bold tracking-[0.15em] mb-8 leading-tight drop-shadow-lg">
                                    {phase >= 4 ? "é€ƒ ã‚² ãƒ© ãƒ¬ ãƒŠ ã‚¤" : <>åœŸã¨ç”Ÿãã‚‹ã€<br className="md:hidden" />å¾ªç’°ã™ã‚‹æœªæ¥ã€‚</>}
                                </h1>
                                <Button variant="secondary" className="border-white text-white hover:bg-white hover:text-primary backdrop-blur-sm bg-white/10" onClick={() => setPage('products')}>
                                    å•†å“ã‚’è¦‹ã‚‹
                                </Button>
                            </div>
                        </div>

                        <div className="absolute bottom-8 left-0 right-0 flex justify-center gap-3 z-30">
                            {slides.map((_, index) => (
                                <button 
                                    key={index}
                                    onClick={() => setCurrentSlide(index)}
                                    className={`w-12 h-1 rounded-full transition-all duration-300 ${currentSlide === index ? 'bg-white opacity-100' : 'bg-white opacity-40 hover:opacity-70'}`}
                                />
                            ))}
                        </div>
                    </div>

                    <div className="py-20 px-6 bg-surface">
                        <div className="max-w-container mx-auto grid md:grid-cols-2 gap-16 md:gap-24">
                            <div>
                                <div className="flex justify-between items-end mb-8 border-b border-border pb-4">
                                    <h3 className="text-2xl font-serif">News</h3>
                                    <span className="text-sm font-eng text-muted cursor-pointer hover:text-primary">View All</span>
                                </div>
                                <ul className="space-y-6">
                                    {phase >= 2 && (
                                        <li 
                                            className="group cursor-pointer"
                                            onClick={() => {
                                                if (!flags.F03) {
                                                    alert("ã€F03: ç®¡ç†äººã‹ã‚‰ã®ãŠçŸ¥ã‚‰ã›ã€‘\nãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¿è­·ã•ã‚ŒãŸã€Œå†…éƒ¨å‘Šç™ºã€ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ã‚’ç™ºè¦‹ã—ãŸã€‚");
                                                    unlockFlag('F03');
                                                }
                                            }}
                                        >
                                            <p className="text-xs text-accent font-eng mb-1">2026.01.20</p>
                                            <p className="group-hover:text-accent transition-colors font-medium">ã€é‡è¦ã€‘ç®¡ç†äººã‹ã‚‰ã®ãŠçŸ¥ã‚‰ã›ï¼ˆé–¢ä¿‚è€…å„ä½ï¼‰</p>
                                        </li>
                                    )}
                                    <li className="group cursor-pointer">
                                        <p className="text-xs text-muted font-eng mb-1">2026.01.15</p>
                                        <p className="group-hover:text-primary transition-colors">æœ¬å¹´ã®ã€Œæœ±å®Ÿï¼ˆã‚ã‘ã¿ï¼‰ã€ã®äºˆç´„å—ä»˜ã‚’é–‹å§‹ã—ã¾ã—ãŸã€‚</p>
                                    </li>
                                    <li className="group cursor-pointer">
                                        <p className="text-xs text-muted font-eng mb-1">2026.01.08</p>
                                        <p className="group-hover:text-primary transition-colors">å†¬å­£å®Ÿç¿’ç”Ÿã®å—ã‘å…¥ã‚Œã‚’å®Ÿæ–½ã—ã¾ã—ãŸã€‚</p>
                                    </li>
                                </ul>
                            </div>
                            
                            <div className="relative pl-8 border-l border-border hidden md:block">
                                <p className="text-lg font-serif leading-loose writing-vertical-rl text-text h-[300px]">
                                    å¥¥ç¥ä¼ã®æ·±ã„æ£®ã«æŠ±ã‹ã‚ŒãŸã“ã®åœ°ã§ã€<br/>
                                    ç§ãŸã¡ã¯åœŸã®å£°ã«è€³ã‚’å‚¾ã‘ã¾ã™ã€‚<br/>
                                    è‡ªç„¶ã®æ‘‚ç†ã«å¾“ã„ã€å‘½ã‚’è‚²ã‚€ã€‚<br/>
                                    ãã‚ŒãŒç§ãŸã¡ã®èª‡ã‚Šã§ã™ã€‚
                                </p>
                            </div>
                        </div>
                    </div>

                    <AdSpace />
                </>
            );
        };

        // 2. VILLAGE (Gallery & Tree)
        const Village = ({ phase, unlockFlag, flags }) => {
            const [lightboxOpen, setLightboxOpen] = useState(false);

            return (
                <div className="min-h-screen pt-24 pb-20">
                    <div className="max-w-container mx-auto px-6">
                        <SectionTitle title="å¥¥ç¥ä¼æ‘ã«ã¤ã„ã¦" sub="OUR VILLAGE" />
                        
                        <div className="mb-20">
                            <img src={phase >= 3 ? IMAGES.village_night : IMAGES.village_normal} alt="Village View" className="w-full h-[60vh] object-cover rounded-2xl shadow-sm mb-8" />
                            <p className="max-w-2xl mx-auto text-center leading-loose text-muted font-serif">
                                å››æ–¹ã‚’é™ºã—ã„å±±ã€…ã«å›²ã¾ã‚ŒãŸå¥¥ç¥ä¼æ‘ã€‚<br/>
                                ç‹¬è‡ªã®æ°—å€™é¢¨åœŸãŒã€ä»–ã«ã¯ãªã„æ¿ƒåšãªå‘³ã‚ã„ã®ä½œç‰©ã‚’è‚²ã¦ã¾ã™ã€‚<br/>
                                å¤ãã‹ã‚‰ã“ã®åœ°ã«ã¯ã€Œç¥ã€ãŒå®¿ã‚‹ã¨è¨€ã‚ã‚Œã€æ‘äººã¯è‡ªç„¶ã‚’æ•¬ã„ã€å…±ã«ç”Ÿãã¦ãã¾ã—ãŸã€‚
                            </p>
                        </div>

                        <div className="mb-24 grid md:grid-cols-2 gap-12 items-center bg-white p-8 rounded-2xl shadow-sm">
                            <div className="order-2 md:order-1">
                                 <h3 className="text-2xl font-serif mb-6 text-text">å†¬ã®é™å¯‚</h3>
                                 <p className="text-muted leading-loose font-serif">
                                     å†¬ã¯é›ªãŒå¤šã„åœ°åŸŸã§ã™ãŒã€ä¸€é¢ã®ç¾ã—ãç™½ã„å§¿ã¸æ‘ãŒå¤‰ã‚ã‚Šã¾ã™ã€‚<br/>
                                     ã—ã‚“ã—ã‚“ã¨é™ã‚Šç©ã‚‚ã‚‹é›ªã®éŸ³ã—ã‹èã“ãˆãªã„ã€é™å¯‚ã«åŒ…ã¾ã‚ŒãŸå†¬ã®å¥¥ç¥ä¼ã‚‚ã¾ãŸæ ¼åˆ¥ã§ã™ã€‚<br/>
                                     å³ã—ã•ã®ä¸­ã§è‚²ã¾ã‚Œã‚‹å‘½ã®åŠ›å¼·ã•ã‚’æ„Ÿã˜ã¦ãã ã•ã„ã€‚
                                 </p>
                            </div>
                            <div className="order-1 md:order-2">
                                <img src={IMAGES.village_snow} alt="Winter Village" className="w-full h-80 object-cover rounded-xl shadow-md hover:scale-[1.02] transition-transform duration-500" />
                            </div>
                        </div>

                        <AdSpace className="mb-24" />

                        <div className="bg-surface-2 rounded-2xl p-8 md:p-16 flex flex-col md:flex-row gap-12 items-center">
                            <div className="md:w-1/2">
                                <h3 className="text-2xl font-serif mb-4">å¾¡ç¥æœ¨</h3>
                                <p className="text-muted leading-relaxed mb-6">
                                    æ‘ã®ä¸­å¿ƒã«ãã³ãˆç«‹ã¤ã€æ¨¹é½¢300å¹´ã‚’è¶…ãˆã‚‹å¤§æ¨¹ã€‚<br/>
                                    æ‘ã®å®ˆã‚Šç¥ã¨ã—ã¦ã€æ³¨é€£ç¸„ã‚’å¼µã‚Šã€å¤§åˆ‡ã«ç¥€ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚<br/>
                                    ãã®æ¨¹çš®ã®æ¨¡æ§˜ã¯ã€è¦‹ã‚‹è€…ã«ã‚ˆã£ã¦æ§˜ã€…ãªå§¿ã«è¦‹ãˆã‚‹ã¨è¨€ã‚ã‚Œã¦ã„ã¾ã™ã€‚
                                </p>
                                <Button 
                                    variant="secondary" 
                                    onClick={() => {
                                        setLightboxOpen(true);
                                        if (phase >= 3 && !flags.F10) {
                                            unlockFlag('F10');
                                        }
                                    }}
                                >
                                    å†™çœŸã‚’æ‹¡å¤§ã—ã¦è¦‹ã‚‹
                                </Button>
                            </div>
                            <div className="md:w-1/2 w-full">
                                <img src={IMAGES.tree_default} alt="Sacred Tree" className="w-full h-80 object-cover rounded-lg shadow-md hover:grayscale transition-all duration-1000 cursor-zoom-in" onClick={() => setLightboxOpen(true)}/>
                            </div>
                        </div>
                    </div>

                    {lightboxOpen && (
                        <div className="fixed inset-0 z-[100] lightbox-overlay flex items-center justify-center p-4" onClick={() => setLightboxOpen(false)}>
                            <div className="relative max-w-4xl w-full max-h-screen">
                                <img 
                                    src={phase >= 3 ? IMAGES.tree_change : IMAGES.tree_default} 
                                    className="w-full h-auto max-h-[90vh] object-contain rounded shadow-2xl" 
                                />
                                {phase >= 3 && (
                                    <div className="absolute bottom-4 left-0 right-0 text-center bg-black/50 text-white p-2">
                                        <p className="font-serif text-sm">ã€F10 è¨¼æ‹ ã€‘æ¨¹çš®ã®ç¶™ãç›®ã«ã€å¤–ç§‘æ‰‹è¡“ã®ã‚ˆã†ãªç¸«åˆç—•ãŒè¦‹ãˆã‚‹...</p>
                                    </div>
                                )}
                                <button className="absolute -top-10 right-0 text-white" onClick={() => setLightboxOpen(false)}>é–‰ã˜ã‚‹</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // 3. ABOUT (Greeting & Staff)
        const About = ({ phase, unlockFlag, flags, setPage, setSelectedStaff }) => {
            const [greeting, setGreeting] = useState("å°æœ¨ã¯ä½™è¨ˆãªæè‘‰ã‚’å‰ªå®šã—ã¾ã™ã€‚è‰¯ã„å®Ÿã‚’ã¤ã‘ã‚‹ãŸã‚ã«ã¯ã€è¦ªã¨ãªã‚‹æœ¨ãŒå¥åº·ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚");
            
            useEffect(() => {
                if (phase >= 2 && !flags.F09) {
                    const timer = setTimeout(() => {
                        setGreeting("æŸ©æœ¨ï¼ˆã²ã¤ãï¼‰ã¯ä½™è¨ˆãªé–¢ç¯€ã‚’å‰ªå®šã—ã¾ã™ã€‚è‰¯ã„å®Ÿã‚’ã¤ã‘ã‚‹ãŸã‚ã«ã¯ã€è¦ªã¨ãªã‚‹ç”Ÿè´„ãŒå¥åº·ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚");
                        unlockFlag('F09');
                    }, 5000);
                    return () => clearTimeout(timer);
                }
            }, [phase, flags.F09]);

            const handleStaffClick = (staff) => {
                setSelectedStaff(staff);
                setPage('staff_detail');
            };

            const StaffCard = ({ staff, isHiddenChar }) => (
                <div 
                    className="bg-surface p-6 rounded-2xl hover-card text-center group h-full cursor-pointer"
                    onClick={() => {
                        if (isHiddenChar) {
                            if (!flags.F06) {
                                alert("ã€F06: éš ã•ã‚ŒãŸå®Ÿç¿’ç”Ÿã€‘\nè¡Œæ–¹ä¸æ˜ã®å®Ÿç¿’ç”Ÿã®ç›£ç¦æ˜ åƒã‚’ç¢ºèªã—ã¾ã—ãŸã€‚");
                                unlockFlag('F06');
                            }
                        } else {
                            handleStaffClick(staff);
                        }
                    }}
                >
                    <div className="w-full aspect-[4/5] overflow-hidden rounded-xl mb-6 relative">
                        <img src={isHiddenChar ? IMAGES.staff_victim : staff.image} alt={isHiddenChar ? "???" : staff.name} className="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" />
                        {isHiddenChar && (
                            <div className="absolute inset-0 bg-black/80 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                                <span className="text-white font-serif">ãƒ‡ãƒ¼ã‚¿ç ´æ</span>
                            </div>
                        )}
                        {!isHiddenChar && (
                            <div className="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors flex items-center justify-center">
                                <span className="bg-white/90 text-text text-xs px-4 py-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity transform translate-y-2 group-hover:translate-y-0 duration-300 font-serif">
                                    è©³ã—ãè¦‹ã‚‹
                                </span>
                            </div>
                        )}
                    </div>
                    <p className="text-primary font-eng text-xs tracking-wider mb-2">{isHiddenChar ? "???" : staff.role}</p>
                    <h4 className="text-xl font-serif font-bold mb-3">{isHiddenChar ? "No.1092" : staff.name}</h4>
                    <p className="text-sm text-muted leading-relaxed relative line-clamp-2">
                        {isHiddenChar ? "..." : staff.short_intro}
                    </p>
                </div>
            );

            return (
                <div className="min-h-screen pt-24 pb-20 bg-surface-2">
                    <div className="max-w-container mx-auto px-6">
                        <SectionTitle title="è¾²åœ’ã«ã¤ã„ã¦" sub="ABOUT US" />

                        <section className="grid md:grid-cols-2 gap-12 md:gap-24 items-center mb-32">
                            <div className="relative order-2 md:order-1">
                                <img src={IMAGES.staff_manager} className="w-full aspect-[4/5] object-cover rounded-2xl shadow-lg" alt="åœ’é•·" />
                                <div className="absolute -bottom-6 -right-6 bg-white p-6 rounded-lg shadow-xl hidden md:block">
                                    <p className="font-serif font-bold text-lg">ç¥å» å·Œ</p>
                                    <p className="text-xs text-muted font-eng">åœ’é•· / Iwao Kamisari</p>
                                </div>
                            </div>
                            <div className="order-1 md:order-2 pt-8">
                                <h3 className="text-2xl md:text-3xl font-serif mb-8 leading-snug">
                                    è‡ªç„¶ã®å£°ã‚’èãã€<br/>å‘½ã‚’ç¹‹ãè¾²æ¥­ã‚’ã€‚
                                </h3>
                                <div className="prose prose-lg text-text font-serif leading-loose mb-8">
                                    <p className="mb-4">
                                        å¥¥ç¥ä¼ãƒ•ã‚¡ãƒ¼ãƒ ã¸ã‚ˆã†ã“ãã€‚<br/>
                                        ç§ãŸã¡ã¯ã€ã“ã®åœŸåœ°ã®ä¼çµ±ã‚’å®ˆã‚ŠãªãŒã‚‰ã€æŒç¶šå¯èƒ½ãªè¾²æ¥­ã«å–ã‚Šçµ„ã‚“ã§ã„ã¾ã™ã€‚
                                    </p>
                                    <p className="transition-all duration-1000 mb-4">
                                        {greeting}
                                    </p>
                                    <p>
                                        åœŸå£Œã®å¾®ç”Ÿç‰©ã€æ£®ã®æœ¨ã€…ã€ãã—ã¦ç§ãŸã¡äººé–“ã€‚ã™ã¹ã¦ãŒå¾ªç’°ã®ä¸­ã«ã‚ã‚Šã¾ã™ã€‚
                                    </p>
                                </div>
                                <div className="hidden md:block">
                                    <img src={IMAGES.top_farm} className="h-32 w-full object-cover rounded-lg opacity-60 grayscale-[30%]" />
                                </div>
                            </div>
                        </section>

                        <section>
                            <div className="text-center mb-16">
                                <h3 className="text-2xl font-serif mb-4">ã‚¹ã‚¿ãƒƒãƒ•ç´¹ä»‹</h3>
                                <p className="text-muted font-eng text-sm tracking-widest">OUR STAFF</p>
                            </div>
                            
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                {STAFF_DATA.map(staff => (
                                    <StaffCard key={staff.id} staff={staff} />
                                ))}
                                
                                {phase >= 3 && (
                                    <StaffCard isHiddenChar={true} />
                                )}
                            </div>
                        </section>
                    </div>
                </div>
            );
        };

        // 3.5 STAFF DETAIL
        const StaffDetail = ({ staff, setPage, unlockFlag, flags }) => {
            useEffect(() => {
                window.scrollTo(0, 0);
            }, []);

            if (!staff) return null;

            return (
                <div className="min-h-screen pt-32 pb-20 bg-surface">
                    <div className="max-w-4xl mx-auto px-6">
                        <button 
                            onClick={() => setPage('about')}
                            className="flex items-center text-sm text-muted hover:text-primary mb-8 transition-colors"
                        >
                            <i data-lucide="arrow-left" className="w-4 h-4 mr-2"></i>
                            ã‚¹ã‚¿ãƒƒãƒ•ä¸€è¦§ã«æˆ»ã‚‹
                        </button>

                        <div className="grid md:grid-cols-2 gap-12 items-start">
                            <div>
                                <div className="aspect-[4/5] w-full rounded-2xl overflow-hidden shadow-lg mb-6">
                                    <img src={staff.image} alt={staff.name} className="w-full h-full object-cover" />
                                </div>
                                <div className="text-center md:text-left">
                                    <p className="text-primary font-eng text-sm tracking-wider font-bold mb-1">{staff.role}</p>
                                    <h2 className="text-3xl font-serif font-bold mb-2">{staff.name}</h2>
                                    <p className="text-sm text-muted">{staff.role_jp}</p>
                                </div>
                            </div>

                            <div className="space-y-10 font-serif leading-loose text-text">
                                <div>
                                    <h3 className="text-lg font-bold border-b border-border pb-2 mb-4">è‡ªå·±ç´¹ä»‹</h3>
                                    <p>
                                        {staff.intro}
                                        {staff.id === 'sato' && (
                                            <span 
                                                className="hidden-sos ml-1 select-all cursor-text"
                                                onMouseUp={() => {
                                                    const selection = window.getSelection().toString();
                                                    if (selection.includes("ç‹‚ã£ã¦ã‚‹") && !flags.F01) {
                                                        alert("ã€F01: å‰¯åœ’é•·ã®éš ã—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‘\nãƒ†ã‚­ã‚¹ãƒˆã‚’åè»¢ã—ã¦ç™ºè¦‹ï¼š\nã€Œã“ã®æ‘ã¯ç‹‚ã£ã¦ã‚‹ã€‚å‡ºã‚‰ã‚Œãªã„ã€‚åŠ©ã‘ã¦ãã‚Œã€");
                                                        unlockFlag('F01');
                                                    }
                                                }}
                                            >
                                                {staff.hidden}
                                            </span>
                                        )}
                                    </p>
                                </div>

                                <div>
                                    <h3 className="text-lg font-bold border-b border-border pb-2 mb-4">è¾²åœ’ã«å…¥ã£ãŸãã£ã‹ã‘</h3>
                                    <p>{staff.reason}</p>
                                </div>

                                <div>
                                    <h3 className="text-lg font-bold border-b border-border pb-2 mb-4">ä»•äº‹ã‚’ã—ã¦ã„ã¦æ¥½ã—ã„ã“ã¨ã€ã‚„ã‚ŠãŒã„</h3>
                                    <p>{staff.joy}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // 4. PRODUCTS
        const Products = ({ phase, unlockFlag, flags }) => {
            const categories = ["ALL", "APPLE", "GRAPES", "PROCESSED"];
            const [videoModalOpen, setVideoModalOpen] = useState(false);

            const products = [
                { 
                    id: 1, 
                    name: "å¥¥ç¥ä¼ã‚Šã‚“ã”ã€Œæœ±å®Ÿã€", 
                    price: "Â¥5,000", 
                    cat: "APPLE", 
                    img: IMAGES.ec_apple,
                    desc: "é©šãã»ã©ã®ç³–åº¦ã¨ã€æ·±ç´…ã®è‰²åˆã„ã€‚è´ˆã‚Šç‰©ã«ã‚‚æœ€é©ã§ã™ã€‚",
                    tags: ["#ç”˜ã„", "#å­£ç¯€é™å®š", "#ã‚®ãƒ•ãƒˆ", "#èœœå…¥ã‚Š", "#ä¿¡å·", "#æœé£Ÿã«"]
                },
                { 
                    id: 2, 
                    name: "æ‰‹ä½œã‚Šã‚¢ãƒƒãƒ—ãƒ«ãƒ‘ã‚¤", 
                    price: "Â¥3,500", 
                    cat: "PROCESSED", 
                    img: IMAGES.ec_applepie, 
                    desc: "ãƒˆãƒ¡ã•ã‚“ç§˜ä¼ã®ãƒ¬ã‚·ãƒ”ã€‚ã‚µã‚¯ã‚µã‚¯ã®ãƒ‘ã‚¤ç”Ÿåœ°ã¨ç”˜é…¸ã£ã±ã„ãƒ•ã‚£ãƒªãƒ³ã‚°ã€‚",
                    tags: ["#æ¯ã®å‘³", "#ç„¡æ·»åŠ ", "#æ‰‹ä½œã‚Š", "#ãŠã‚„ã¤", "#ç„¼ããŸã¦", "#äººæ°—No.1"]
                },
                { 
                    id: 3, 
                    name: "æœ‰æ©Ÿæ ½åŸ¹ãƒ–ãƒ‰ã‚¦", 
                    price: "Â¥8,000", 
                    cat: "GRAPES", 
                    img: IMAGES.ec_grape, 
                    desc: "æ¥ãæœ¨æŠ€è¡“ã®çµæ™¶ã€‚æ·±ã„ã‚³ã‚¯ã¨é¦™ã‚Šã‚’ãŠæ¥½ã—ã¿ãã ã•ã„ã€‚",
                    tags: ["#é•·é‡çœŒç”£", "#æœ‰æ©ŸJAS", "#èŠ³é†‡ãªé¦™ã‚Š", "#ã‚­ãƒ…ã‚¤ãƒ†", "#å¸Œå°‘å“ç¨®", "#ãƒ¯ã‚¤ãƒ³ç”¨", "#çš®ã”ã¨é£Ÿã¹ã‚‰ã‚Œã‚‹", "#ç§‹ã®å‘³è¦š", "#è´ˆç­”ç”¨"]
                },
                { 
                    id: 4, 
                    name: "ç‰¹è£½ã‚¸ãƒ£ãƒ ", 
                    price: "Â¥1,200", 
                    cat: "PROCESSED", 
                    img: IMAGES.ec_jam, 
                    desc: "å®Œç†Ÿæœå®Ÿã‚’ãã®ã¾ã¾ç…®è©°ã‚ã¾ã—ãŸã€‚ãƒ¨ãƒ¼ã‚°ãƒ«ãƒˆã«æœ€é©ã€‚",
                    tags: ["#æœé£Ÿ", "#ã‚ªãƒ¼ã‚¬ãƒ‹ãƒƒã‚¯", "#ä¿å­˜æ–™ä¸ä½¿ç”¨", "#ãƒ¨ãƒ¼ã‚°ãƒ«ãƒˆã«"]
                },
                { 
                    id: 5, 
                    name: "å­£ç¯€ã®è©°ã‚åˆã‚ã›", 
                    price: "Â¥10,000", 
                    cat: "ALL", 
                    img: IMAGES.ec_set, 
                    desc: "æ—¬ã®å‘³è¦šã‚’è´…æ²¢ã«è©°ã‚åˆã‚ã›ã¾ã—ãŸã€‚ã”è´ˆç­”ç”¨ã«ã€‚",
                    tags: ["#æ•°é‡é™å®š", "#ãŠä¸­å…ƒ", "#é€æ–™ç„¡æ–™", "#ãƒ•ã‚¡ãƒŸãƒªãƒ¼å‘ã‘"]
                },
                { 
                    id: 6, 
                    name: "Coming Soon...", 
                    price: "-", 
                    cat: "ALL", 
                    img: IMAGES.icon_default, 
                    desc: "æ–°ã—ã„å•†å“ã®æº–å‚™ä¸­ã§ã™ã€‚ã”æœŸå¾…ãã ã•ã„ã€‚",
                    tags: [],
                    isComingSoon: true
                },
            ];

            return (
                <div className="min-h-screen pt-24 pb-20">
                    <div className="max-w-container mx-auto px-6">
                        <SectionTitle title="å•†å“ä¸€è¦§" sub="PRODUCTS" />

                        <div className="flex flex-wrap justify-center gap-4 md:gap-8 mb-16">
                            {categories.map((cat, idx) => (
                                <button key={cat} className={`text-sm font-eng tracking-widest px-4 py-2 rounded-full transition-colors ${idx === 0 ? 'bg-text text-white' : 'text-muted hover:bg-surface-2'}`}>
                                    {cat}
                                </button>
                            ))}
                        </div>

                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-12 mb-20">
                            {products.map(p => (
                                <div key={p.id} className={`group cursor-pointer ${p.isComingSoon ? 'opacity-60' : ''}`}>
                                    <div className="aspect-square overflow-hidden rounded-2xl mb-4 bg-surface-2 relative flex items-center justify-center">
                                        {p.isComingSoon ? (
                                            <div className="text-center">
                                                <img src={p.img} alt={p.name} className="w-20 h-20 opacity-30 mx-auto mb-2" />
                                                <span className="font-eng tracking-widest text-muted">Coming Soon</span>
                                            </div>
                                        ) : (
                                            <img src={p.img} alt={p.name} className="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" />
                                        )}
                                    </div>
                                    <div className="text-left">
                                        <div className="flex justify-between items-baseline mb-2">
                                            <h3 className="text-lg font-serif font-bold">{p.name}</h3>
                                            <p className="text-sm font-eng text-muted">{p.price}</p>
                                        </div>
                                        <p className="text-sm text-muted mb-4 leading-relaxed border-b border-border pb-4">{p.desc}</p>
                                        
                                        <div className="flex flex-wrap gap-2">
                                            {p.tags.map((tag, i) => (
                                                <span 
                                                    key={i}
                                                    className={`text-[11px] px-2 py-1 rounded border border-border text-muted transition-colors hover:bg-gray-100 ${tag === "#ã‚­ãƒ…ã‚¤ãƒ†" ? "cursor-help hover:text-accent" : "cursor-default"}`}
                                                    onClick={(e) => {
                                                        if (tag === "#ã‚­ãƒ…ã‚¤ãƒ†") {
                                                            e.stopPropagation();
                                                            setVideoModalOpen(true);
                                                            if(!flags.F02) unlockFlag('F02');
                                                        }
                                                    }}
                                                >
                                                    {tag}
                                                </span>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>

                        <AdSpace />
                    </div>

                    {videoModalOpen && (
                        <div className="fixed inset-0 z-[100] bg-black/90 flex items-center justify-center p-4" onClick={() => setVideoModalOpen(false)}>
                            <div className="relative w-full max-w-4xl aspect-video bg-black rounded-lg overflow-hidden shadow-2xl" onClick={e => e.stopPropagation()}>
                                <video 
                                    src={IMAGES.victim_movie} 
                                    controls 
                                    autoPlay 
                                    playsInline
                                    className="w-full h-full"
                                >
                                    Your browser does not support the video tag.
                                </video>
                                <button 
                                    className="absolute -top-10 right-0 text-white font-bold hover:text-accent transition-colors" 
                                    onClick={() => setVideoModalOpen(false)}
                                >
                                    [é–‰ã˜ã‚‹]
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // 5. DIARY (List)
        const Diary = ({ phase, unlockFlag, flags, setPage, setSelectedArticle }) => {
            const [search, setSearch] = useState("");
            const [isAncient, setIsAncient] = useState(false);

            const handleSearch = (e) => {
                e.preventDefault();
                if (phase >= 3 && search === "1826" && !flags.F07) {
                    setIsAncient(true);
                    unlockFlag('F07');
                    alert("ã€F07: å¤ã„ãƒ–ãƒ­ã‚°ã€‘\n1826å¹´ã®å¤æ–‡æ›¸ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã—ãŸã€‚");
                }
            };

            const handleArticleClick = (article) => {
                if (article.id === 99) { // å¤æ–‡æ›¸ã¯è©³ç´°ãªã—ï¼ˆã¾ãŸã¯ç‰¹åˆ¥å‡¦ç†ï¼‰
                    return;
                }
                setSelectedArticle(article);
                setPage('article_detail');
            };

            const ancientArticles = [
                { id: 99, date: "1826.04.04", title: "é–‹æ‘ã®å„€å¼ã«é–¢ã™ã‚‹è¦šæ›¸", desc: "æŸ©æœ¨ï¼ˆã²ã¤ãï¼‰ã‚’é¸å®šã—ã€åœŸã«ä¼ã›...", img: IMAGES.blog_oldbook }
            ];

            const displayArticles = isAncient ? ancientArticles : BLOG_DATA;

            return (
                <div className={`min-h-screen pt-24 pb-20 ${isAncient ? 'bg-[#EAE0D5] text-[#4A3B32]' : ''}`}>
                    <div className="max-w-container mx-auto px-6">
                        <SectionTitle title="æ´»å‹•æ—¥èªŒ" sub="FARM DIARY" />

                        <div className="flex flex-col md:flex-row gap-12">
                            <div className="md:w-1/4">
                                <form onSubmit={handleSearch} className="relative mb-8">
                                    <input 
                                        type="text" 
                                        placeholder="æ¤œç´¢..." 
                                        className="w-full border-b border-border bg-transparent py-2 pr-8 outline-none focus:border-primary font-sans text-sm"
                                        value={search}
                                        onChange={(e) => setSearch(e.target.value)}
                                    />
                                    <i data-lucide="search" className="absolute right-0 top-2 w-4 h-4 text-muted"></i>
                                </form>
                                <div className="space-y-2 text-sm text-muted font-serif">
                                    <p>ã‚«ãƒ†ã‚´ãƒªãƒ¼</p>
                                    <ul className="pl-4 space-y-1 border-l border-border">
                                        <li className="hover:text-primary cursor-pointer">è¾²åœ’ã®æ—¥å¸¸</li>
                                        <li className="hover:text-primary cursor-pointer">ãƒ¬ã‚·ãƒ”</li>
                                        <li className="hover:text-primary cursor-pointer">ã‚¤ãƒ™ãƒ³ãƒˆ</li>
                                    </ul>
                                </div>
                                
                                <AdSpace className="mt-12 hidden md:block" />
                            </div>

                            <div className="md:w-3/4 space-y-12">
                                {displayArticles.map(article => (
                                    <article key={article.id} className="group cursor-pointer" onClick={() => handleArticleClick(article)}>
                                        <div className="flex flex-col md:flex-row gap-6 items-start">
                                            <div className="md:w-1/3 aspect-video bg-surface-2 rounded-lg overflow-hidden">
                                                <img src={article.img} className="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105" />
                                            </div>
                                            <div className="md:w-2/3">
                                                <p className="text-xs font-eng text-muted mb-2">{article.date}</p>
                                                <h3 className={`text-xl font-serif font-bold mb-3 ${isAncient ? 'font-serif' : ''}`}>{article.title}</h3>
                                                <p className="text-sm text-muted leading-relaxed mb-4">{article.desc}</p>
                                                <span className="text-primary text-sm font-medium hover:underline">ç¶šãã‚’èª­ã‚€ â†’</span>
                                            </div>
                                        </div>
                                    </article>
                                ))}
                                
                                <AdSpace />
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // 5.5 ARTICLE DETAIL
        const ArticleDetail = ({ article, setPage, unlockFlag, flags }) => {
            useEffect(() => {
                window.scrollTo(0, 0);
            }, []);

            if (!article) return null;

            return (
                <div className="min-h-screen pt-32 pb-20 bg-surface">
                    <div className="max-w-3xl mx-auto px-6">
                        <button 
                            onClick={() => setPage('diary')}
                            className="flex items-center text-sm text-muted hover:text-primary mb-8 transition-colors"
                        >
                            <i data-lucide="arrow-left" className="w-4 h-4 mr-2"></i>
                            è¨˜äº‹ä¸€è¦§ã«æˆ»ã‚‹
                        </button>

                        <article className="prose prose-stone lg:prose-lg mx-auto">
                            <div className="mb-8 text-center">
                                <p className="text-sm text-muted font-eng mb-2">{article.date}</p>
                                <h1 className="text-3xl font-serif font-bold mb-6 leading-relaxed">{article.title}</h1>
                                <div className="w-full aspect-video rounded-xl overflow-hidden mb-8 shadow-sm">
                                    <img src={article.img} alt={article.title} className="w-full h-full object-cover" />
                                </div>
                            </div>

                            <div className="font-serif leading-loose text-text space-y-6">
                                {article.content.split('\n').map((line, i) => (
                                    line === "" ? <br key={i} /> : <p key={i}>{line}</p>
                                ))}
                            </div>

                            {/* F04: Recipe Gimmick Link */}
                            {article.isRecipe && (
                                <div className="mt-12 p-6 border-t border-b border-border text-center">
                                    <p className="mb-4 font-bold">â–¼ è©³ã—ãã¯ã“ã¡ã‚‰</p>
                                    <span 
                                        className="text-accent underline cursor-pointer text-lg hover:text-red-700 transition-colors font-serif"
                                        onClick={() => {
                                            setPage('recipe'); // Recipe page transition
                                        }}
                                    >
                                        â–¶ ã‚¢ãƒƒãƒ—ãƒ«ãƒ‘ã‚¤ã®ãƒ¬ã‚·ãƒ”ã‚’å…¬é–‹ï¼
                                    </span>
                                </div>
                            )}
                        </article>

                        <div className="mt-20 border-t border-border pt-12">
                            <AdSpace />
                        </div>
                    </div>
                </div>
            );
        };

        // 5.6 RECIPE DETAIL (F04 Page)
        const RecipeDetail = ({ setPage, unlockFlag, flags }) => {
            useEffect(() => {
                window.scrollTo(0, 0);
                if (!flags.F04) {
                    alert("ã€F04: ã‚¢ãƒƒãƒ—ãƒ«ãƒ‘ã‚¤ã®ç§˜å¯†ã€‘\nãƒ¬ã‚·ãƒ”ãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤ºï¼š\nã‚ˆãè¦‹ã‚‹ã¨ã€ææ–™ã‚„æ‰‹é †ã«ä¸ç©ãªè¨˜è¿°ãŒæ··ã–ã£ã¦ã„ã‚‹...");
                    unlockFlag('F04');
                }
            }, []);

            return (
                <div className="min-h-screen pt-32 pb-20 bg-[#F9F7F2]">
                    <div className="max-w-3xl mx-auto px-6">
                        <button 
                            onClick={() => setPage('diary')}
                            className="flex items-center text-sm text-muted hover:text-primary mb-8 transition-colors"
                        >
                            <i data-lucide="arrow-left" className="w-4 h-4 mr-2"></i>
                            è¨˜äº‹ã«æˆ»ã‚‹
                        </button>

                        <div className="bg-white p-8 md:p-16 shadow-sm rounded-lg border border-[#E6E8E2]">
                            <h1 className="text-3xl font-serif font-bold text-center mb-12 text-[#8A2E2E]">ãƒˆãƒ¡ã•ã‚“ã®ç‰¹è£½ã‚¢ãƒƒãƒ—ãƒ«ãƒ‘ã‚¤</h1>
                            
                            <div className="flex flex-col md:flex-row gap-12 mb-16">
                                <div className="md:w-1/2">
                                    <div className="aspect-square bg-gray-100 rounded-lg flex items-center justify-center text-muted text-sm border border-dashed border-gray-300">
                                        [ç”»åƒï¼šç„¼ãä¸ŠãŒã£ãŸãƒ‘ã‚¤]
                                    </div>
                                </div>
                                <div className="md:w-1/2">
                                    <h3 className="text-xl font-serif font-bold mb-6 border-b pb-2">ææ–™ (1ãƒ›ãƒ¼ãƒ«åˆ†)</h3>
                                    <ul className="space-y-3 font-serif">
                                        <li className="flex justify-between border-b border-dotted pb-1">
                                            <span>ã‚Šã‚“ã” (æœ±å®Ÿ)</span>
                                            <span>3å€‹ (è‹¥ãæ–°é®®ãªã‚‚ã®)</span>
                                        </li>
                                        <li className="flex justify-between border-b border-dotted pb-1">
                                            <span>å†·å‡ãƒ‘ã‚¤ã‚·ãƒ¼ãƒˆ</span>
                                            <span>2æš</span>
                                        </li>
                                        <li className="flex justify-between border-b border-dotted pb-1">
                                            <span>ç ‚ç³–</span>
                                            <span>60g</span>
                                        </li>
                                        <li className="flex justify-between border-b border-dotted pb-1">
                                            <span>ãƒã‚¿ãƒ¼</span>
                                            <span>20g</span>
                                        </li>
                                        <li className="flex justify-between border-b border-dotted pb-1">
                                            <span>ã‚·ãƒŠãƒ¢ãƒ³</span>
                                            <span>å°‘ã€…</span>
                                        </li>
                                        <li className="flex justify-between border-b border-dotted pb-1 text-gray-400 text-xs">
                                            <span>ç¡çœ å°å…¥å‰¤</span>
                                            <span>é©é‡ (æ··å…¥ç”¨)</span>
                                        </li>
                                        <li className="flex justify-between border-b border-dotted pb-1">
                                            <span>åµé»„</span>
                                            <span>1å€‹åˆ†</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>

                            <div className="space-y-8 font-serif leading-loose">
                                <h3 className="text-xl font-bold mb-6 border-b pb-2 text-center">ä½œã‚Šæ–¹</h3>
                                
                                <div>
                                    <h4 className="font-bold text-[#2F6B3E] mb-2">1. ä¸‹æº–å‚™</h4>
                                    <p>
                                        ã‚Šã‚“ã”ã¯çš®ã‚’ã‚€ãã€8ç­‰åˆ†ã®ãã—å½¢ã«åˆ‡ã‚Šã¾ã™ã€‚<br/>
                                        <span className="text-xs text-gray-400">â€»èŠ¯ï¼ˆå¿ƒè‡“ï¼‰ã¯ä¸å¯§ã«å–ã‚Šé™¤ã„ã¦ãã ã•ã„ã€‚</span>
                                    </p>
                                </div>

                                <div>
                                    <h4 className="font-bold text-[#2F6B3E] mb-2">2. ç…®è©°ã‚ã‚‹</h4>
                                    <p>
                                        é‹ã«ã‚Šã‚“ã”ã€ç ‚ç³–ã€ãƒã‚¿ãƒ¼ã‚’å…¥ã‚Œã¦ä¸­ç«ã«ã‹ã‘ã¾ã™ã€‚<br/>
                                        æ°´åˆ†ãŒå‡ºã¦ããŸã‚‰å¼±ç«ã«ã—ã€é€ãé€šã‚‹ã¾ã§ã˜ã£ãã‚Šç…®è¾¼ã¿ã¾ã™ã€‚<br/>
                                        <span className="text-xs text-gray-400">â€»èµ¤ãæŸ“ã¾ã‚‹ã¾ã§ã€ç„¦ã‚‰ãšã‚†ã£ãã‚Šã¨ã€‚</span>
                                    </p>
                                </div>

                                <div>
                                    <h4 className="font-bold text-[#2F6B3E] mb-2">3. åŒ…ã‚€</h4>
                                    <p>
                                        ãƒ‘ã‚¤ã‚·ãƒ¼ãƒˆã‚’ä¼¸ã°ã—ã€å†·ã¾ã—ãŸã‚Šã‚“ã”ã‚’éš™é–“ãªãä¸¦ã¹ã¾ã™ã€‚<br/>
                                        ã‚‚ã†ä¸€æšã®ãƒ‘ã‚¤ã‚·ãƒ¼ãƒˆã‚’è¢«ã›ã€ç«¯ã‚’ãƒ•ã‚©ãƒ¼ã‚¯ã§ã—ã£ã‹ã‚Šã¨é–‰ã˜ã¾ã™ã€‚<br/>
                                        <span className="text-xs text-gray-400">â€»é€ƒã’å‡ºã•ãªã„ã‚ˆã†ã«ã€å¼·ãæŠ¼ã—ä»˜ã‘ã¦å›ºå®šã—ã¾ã™ã€‚</span>
                                    </p>
                                </div>

                                <div>
                                    <h4 className="font-bold text-[#2F6B3E] mb-2">4. ç„¼ã</h4>
                                    <p>
                                        è¡¨é¢ã«åµé»„ã‚’å¡—ã‚Šã€200â„ƒã®ã‚ªãƒ¼ãƒ–ãƒ³ã§20åˆ†ç„¼ãã¾ã™ã€‚<br/>
                                        ã“ã‚“ãŒã‚Šã¨è‰¯ã„è‰²ãŒã¤ãã€ç”˜ã„é¦™ã‚ŠãŒéƒ¨å±‹ã«å……æº€ã—ãŸã‚‰å®Œæˆã§ã™ã€‚<br/>
                                        <span className="text-xs text-gray-400">â€»æ„è­˜ãŒé ã®ãã®ã‚’ç¢ºèªã—ã¦ã‹ã‚‰ã€ãŠå¬ã—ä¸ŠãŒã‚Šãã ã•ã„ã€‚</span>
                                    </p>
                                </div>
                            </div>

                            <div className="mt-16 text-center">
                                <div className="inline-block border border-[#8A2E2E] p-4 rounded-lg">
                                    <p className="font-bold text-[#8A2E2E] mb-2">ãƒˆãƒ¡ã®ãƒ¯ãƒ³ãƒã‚¤ãƒ³ãƒˆ</p>
                                    <p className="text-sm">
                                        ç„¼ããŸã¦ã®ã‚¢ãƒ„ã‚¢ãƒ„ã«ãƒãƒ‹ãƒ©ã‚¢ã‚¤ã‚¹ã‚’æ·»ãˆã‚‹ã¨æœ€é«˜ã§ã™ã‚ˆã€‚<br/>
                                        å†·ã‚ã¦ã‚‚ç¾å‘³ã—ã„ã§ã™ãŒã€æ¸©ã‚ç›´ã™ã¨é¦™ã‚ŠãŒæˆ»ã‚Šã¾ã™ã€‚
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // 6. ACCESS (Table & PDF)
        const Access = ({ phase, unlockFlag, flags }) => {
            return (
                <div className="min-h-screen pt-24 pb-20">
                    <div className="max-w-container mx-auto px-6">
                        <SectionTitle title="ã‚¢ã‚¯ã‚»ã‚¹" sub="ACCESS" />
                        
                        <div className="bg-surface rounded-2xl p-8 md:p-12 shadow-sm mb-12">
                            <div className="aspect-video w-full bg-surface-2 rounded-xl mb-8 overflow-hidden relative">
                                <img src={IMAGES.access_map} className="w-full h-full object-cover" />
                                <div className="absolute inset-0 flex items-center justify-center bg-black/10">
                                    <span className="bg-white px-4 py-2 font-eng text-sm tracking-widest shadow">OKUKAMIFUSHI MAP</span>
                                </div>
                            </div>

                            <div className="grid md:grid-cols-2 gap-12">
                                <div>
                                    <h3 className="text-xl font-serif font-bold mb-6">ãŠè»Šã§ãŠè¶Šã—ã®å ´åˆ</h3>
                                    <table className="w-full text-sm text-left">
                                        <tbody>
                                            <tr className="border-b border-border">
                                                <th className="py-4 font-normal text-muted">é•·é‡ICã‚ˆã‚Š</th>
                                                <td className="py-4">çœŒé“00å·ç·šã‚’å—ã¸ ç´„90åˆ†</td>
                                            </tr>
                                            <tr className="border-b border-border">
                                                <th className="py-4 font-normal text-muted">é§è»Šå ´</th>
                                                <td className="py-4">ã‚ã‚Šï¼ˆè¦äºˆç´„ï¼‰</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div className="flex flex-col justify-center items-start">
                                    <p className="text-sm text-muted mb-6 leading-relaxed">
                                        è©³ç´°ãªä½æ‰€ã¯ã€ã”äºˆç´„ç¢ºå®šå¾Œã«ãƒ¡ãƒ¼ãƒ«ã«ã¦ã”æ¡ˆå†…ã„ãŸã—ã¾ã™ã€‚<br/>
                                        å±±é“ãŒç¶šãã¾ã™ã®ã§ã€ãŠæ°—ã‚’ã¤ã‘ã¦ãŠè¶Šã—ãã ã•ã„ã€‚
                                    </p>
                                    <Button variant="secondary" onClick={() => {
                                        if (!flags.F11) {
                                            alert("ã€F11: è¬ã®åœ°å›³ã€‘\nåœ°å›³ã®è£é¢ã«ã€æ ½åŸ¹å·¥ç¨‹ã§ã¯ãªãã€Œäººæ¥ãã€ã®å·¥ç¨‹è¡¨ãŒæ›¸ã‹ã‚Œã¦ã„ã‚‹ã®ã‚’ç™ºè¦‹ã—ãŸã€‚");
                                            unlockFlag('F11');
                                        }
                                    }}>
                                        <i data-lucide="printer" className="w-4 h-4 mr-2"></i>
                                        è©³ç´°åœ°å›³ã‚’å°åˆ· (PDF)
                                    </Button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // 7. RECRUIT (Timeline & Checkbox)
        const Recruit = ({ phase, unlockFlag, flags }) => {
            const [checks, setChecks] = useState({});
            const [horrorStates, setHorrorStates] = useState({});

            const recruitItems = [
                { id: 'farm_love', label: 'è¾²ä½œæ¥­ãŒå¥½ãï¼æ—¥æœ¬ã®è¾²æ¥­ã«èˆˆå‘³ãŒã‚ã‚‹ï¼' },
                { id: 'morning', label: 'æœãŒå¾—æ„ï¼' },
                { id: 'group_life', label: 'ã¿ã‚“ãªã§ã®å…±åŒç”Ÿæ´»ã‚’æ¥½ã—ã‚ã‚‹ï¼' },
                { id: 'learn_jp', label: 'æ—¥æœ¬èªã‚’å­¦ã‚“ã§ã¿ãŸã„ï¼' },
                { id: 'stay_jp', label: 'æ—¥æœ¬ã§ã®æ»åœ¨ã‚’æ¥½ã—ã‚ã‚‹ï¼', horror: 'ãƒ‹ã‚²ãƒ©ãƒ¬ãƒŠã‚¤â€¦' },
                { id: 'nature_life', label: 'è‡ªç„¶ãŒå¤šã„æš®ã‚‰ã—ã«æ†§ã‚Œã‚‹ï¼' },
                { id: 'like_fruit', label: 'æœç‰©ã‚„é‡èœãŒå¥½ãï¼', horror: 'ã‚¤ã‚±ãƒ‹ã‚¨ã‚µãƒ¬ãƒ«â€¦' },
                { id: 'health', label: 'å¥åº·ãŒã¨ã‚Šãˆã ï¼' },
                { id: 'alone', label: 'ä¸€äººæš®ã‚‰ã—ã‚‚ã¸ã£ã¡ã‚ƒã‚‰ã ï¼' },
                { id: 'work_here', label: 'å¥¥ç¥ä¼æ‘ã§åƒããŸã„ï¼', horror: 'ã‚¯ãƒ«ãƒŠâ€¦ï¼ï¼ï¼ï¼ï¼ï¼' },
            ];
            
            const handleCheck = (item) => {
                const isChecked = !checks[item.id];
                setChecks(prev => ({ ...prev, [item.id]: isChecked }));

                // ãƒ›ãƒ©ãƒ¼æ¼”å‡ºãƒ­ã‚¸ãƒƒã‚¯ (ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚ŒãŸæ™‚ã€ã‹ã¤ãƒ›ãƒ©ãƒ¼è¨­å®šãŒã‚ã‚‹å ´åˆ)
                if (isChecked && item.horror) {
                    // ãƒ›ãƒ©ãƒ¼è¡¨ç¤ºON
                    setHorrorStates(prev => ({ ...prev, [item.id]: true }));
                    
                    // F05ãƒ•ãƒ©ã‚°è§£é™¤: æ¼”å‡ºã‚’è¦‹ãŸæ™‚
                    if (!flags.F05) {
                        // å°‘ã—é…å»¶ã•ã›ã¦ã‚¢ãƒ©ãƒ¼ãƒˆã‚’å‡ºã™ï¼ˆæ¼”å‡ºã‚’è¦‹ã›ã‚‹ãŸã‚ï¼‰
                        setTimeout(() => {
                            alert("ã€F05: å¤–å›½äººå®Ÿç¿’ç”Ÿã®ç§˜å¯†ã€‘\nãƒã‚§ãƒƒã‚¯é …ç›®ã®æ–‡å­—ãŒä¸€ç¬å¤‰åŒ–ã—ãŸã€‚\nã€Œãƒ‹ã‚²ãƒ©ãƒ¬ãƒŠã‚¤ã€ã€Œã‚¤ã‚±ãƒ‹ã‚¨ã€...\nã“ã‚Œã¯å‹Ÿé›†ã§ã¯ãªãã€é¸åˆ¥ã ã€‚");
                            unlockFlag('F05');
                        }, 600);
                    }

                    // 0.5ç§’å¾Œã«å…ƒã«æˆ»ã™
                    setTimeout(() => {
                        setHorrorStates(prev => ({ ...prev, [item.id]: false }));
                    }, 500);
                }
            };

            return (
                <div className="min-h-screen pt-24 pb-20 bg-surface-2">
                    <div className="max-w-container mx-auto px-6">
                        <SectionTitle title="æ¡ç”¨æƒ…å ±" sub="RECRUIT" />

                        <div className="grid md:grid-cols-2 gap-12 mb-20">
                            <div>
                                <img src={IMAGES.recruiting} className="w-full h-full object-cover rounded-2xl shadow-lg" />
                            </div>
                            <div className="flex flex-col justify-center">
                                <h3 className="text-2xl font-serif mb-6">æµ·å¤–æŠ€èƒ½å®Ÿç¿’ç”Ÿ å‹Ÿé›†ä¸­</h3>
                                <p className="leading-loose text-muted mb-8">
                                    æ—¥æœ¬ã®ä¼çµ±çš„ãªè¾²æ¥­æŠ€è¡“ã‚’å­¦ã³ã¾ã›ã‚“ã‹ï¼Ÿ<br/>
                                    ç§ãŸã¡ã¯ã€ä¸–ç•Œä¸­ã‹ã‚‰æ„æ¬²ã‚ã‚‹è‹¥è€…ã‚’å—ã‘å…¥ã‚Œã¦ã„ã¾ã™ã€‚<br/>
                                    è‡ªç„¶è±Šã‹ãªç’°å¢ƒã§ã€å…±ã«æ±—ã‚’æµã—ã€çµ†ã‚’æ·±ã‚ã¾ã—ã‚‡ã†ã€‚
                                </p>
                                <ul className="space-y-4 text-sm">
                                    <li className="flex items-center gap-3"><i data-lucide="check" className="text-primary w-5"></i> å¯®å®Œå‚™ãƒ»é£Ÿäº‹ä»˜ã</li>
                                    <li className="flex items-center gap-3"><i data-lucide="check" className="text-primary w-5"></i> æ—¥æœ¬èªå­¦ç¿’ã‚µãƒãƒ¼ãƒˆã‚ã‚Š</li>
                                    <li className="flex items-center gap-3"><i data-lucide="check" className="text-primary w-5"></i> ã‚¢ãƒƒãƒˆãƒ›ãƒ¼ãƒ ãªè·å ´</li>
                                </ul>
                            </div>
                        </div>

                        <div className="bg-surface p-8 md:p-12 rounded-2xl max-w-3xl mx-auto shadow-sm">
                            <h4 className="font-bold font-serif text-xl mb-8 text-center text-primary">ã“ã‚“ãªã‚ãªãŸã‚’å‹Ÿé›†ä¸­ï¼</h4>
                            <div className="space-y-4">
                                {recruitItems.map((item) => (
                                    <label 
                                        key={item.id}
                                        className={`flex items-center gap-4 p-4 border rounded-lg cursor-pointer transition-all duration-200 ${
                                            checks[item.id] ? 'bg-primary/5 border-primary' : 'bg-white border-border hover:bg-surface-2'
                                        }`}
                                    >
                                        <input 
                                            type="checkbox" 
                                            checked={!!checks[item.id]} 
                                            onChange={() => handleCheck(item)} 
                                            className="accent-primary w-5 h-5 shrink-0" 
                                        />
                                        <span 
                                            className={`text-sm font-medium transition-colors duration-100 ${
                                                horrorStates[item.id] 
                                                    ? 'text-[#8A2E2E] font-bold text-lg tracking-widest' // ãƒ›ãƒ©ãƒ¼æ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ«
                                                    : 'text-text'
                                            }`}
                                        >
                                            {horrorStates[item.id] ? item.horror : item.label}
                                        </span>
                                    </label>
                                ))}
                            </div>
                            <p className="text-xs text-center text-muted mt-8">
                                â€»ä¸€ã¤ã§ã‚‚å½“ã¦ã¯ã¾ã‚‹æ–¹ã¯ã€ãœã²ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        // 8. CONTACT (Form Hijack)
        const Contact = ({ phase, unlockFlag, flags }) => {
            const [placeholder, setPlaceholder] = useState("å±±ç”° å¤ªéƒ");
            
            const handleFocus = () => {
                if (phase >= 1 && !flags.F12) {
                    setPlaceholder("åŠ©ã‘ã¦åŠ©ã‘ã¦åŠ©ã‘ã¦åŠ©ã‘ã¦");
                    setTimeout(() => {
                        setPlaceholder("å±±ç”° å¤ªéƒ");
                        alert("ã€F12: å•ã„åˆã‚ã›ã®ä¹—ã£å–ã‚Šã€‘\nå…¥åŠ›æ¬„ãŒä¸€ç¬ã€ŒåŠ©ã‘ã¦ã€ã«å¤‰åŒ–ã—ãŸã€‚ä½•è€…ã‹ãŒSOSã‚’é€ã£ã¦ã„ã‚‹ã€‚");
                        unlockFlag('F12');
                    }, 300);
                }
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                if (phase >= 4) {
                    const evidenceCount = Object.values(flags).filter(Boolean).length;
                    if (evidenceCount >= 10) {
                         alert("ã€TRUE ENDã€‘\nå…¨å“¡é€®æ•ã€‚ä½è—¤å‰¯åœ’é•·ã¯æ•‘å‡ºã•ã‚ŒãŸã€‚");
                    } else {
                         alert("ã€NORMAL ENDã€‘\nè­¦å¯ŸãŒåˆ°ç€ã—ãŸãŒã€ä¸»è¦ãƒ¡ãƒ³ãƒãƒ¼ã¯é€ƒäº¡ã—ã¦ã„ãŸã€‚");
                    }
                    unlockFlag('F13');
                } else {
                    alert("ç¾åœ¨ã€ãŠå•ã„åˆã‚ã›ãŒæ··é›‘ã—ã¦ãŠã‚Šã¾ã™ã€‚");
                }
            };

            return (
                <div className="min-h-screen pt-24 pb-20">
                    <div className="max-w-container mx-auto px-6">
                        <SectionTitle title={phase >= 4 ? "åŒ¿åé€šå ±" : "ãŠå•ã„åˆã‚ã›"} sub={phase >= 4 ? "REPORT" : "CONTACT"} />

                        <div className="max-w-3xl mx-auto grid md:grid-cols-3 gap-12">
                            <div className="md:col-span-2">
                                <form className="space-y-8" onSubmit={handleSubmit}>
                                    <div className="space-y-2">
                                        <label className="text-xs font-bold text-muted tracking-wider">ãŠåå‰ <span className="text-accent">*</span></label>
                                        <input 
                                            type="text" 
                                            className="w-full border-b border-border bg-transparent py-2 outline-none focus:border-primary transition-colors text-lg"
                                            placeholder={placeholder}
                                            onFocus={handleFocus}
                                            required
                                        />
                                    </div>
                                    <div className="space-y-2">
                                        <label className="text-xs font-bold text-muted tracking-wider">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span className="text-accent">*</span></label>
                                        <input 
                                            type="email" 
                                            className="w-full border-b border-border bg-transparent py-2 outline-none focus:border-primary transition-colors text-lg"
                                            placeholder="example@email.com"
                                            required
                                        />
                                    </div>
                                    <div className="space-y-2">
                                        <label className="text-xs font-bold text-muted tracking-wider">
                                            {phase >= 4 ? "é€šå ±å†…å®¹ãƒ»ç‰¹å®šã—ãŸä½æ‰€" : "ãŠå•ã„åˆã‚ã›å†…å®¹"} <span className="text-accent">*</span>
                                        </label>
                                        <textarea 
                                            rows="5" 
                                            className="w-full border-b border-border bg-transparent py-2 outline-none focus:border-primary transition-colors text-base resize-none"
                                            placeholder={phase >= 4 ? "ä½æ‰€ã¨è¨¼æ‹ ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„" : "ã”è³ªå•ã‚’ã”è¨˜å…¥ãã ã•ã„"}
                                            required
                                        ></textarea>
                                    </div>
                                    <Button type="submit" className={`w-full py-4 ${phase >= 4 ? 'bg-accent hover:bg-red-900' : ''}`}>
                                        {phase >= 4 ? "è­¦å¯Ÿã«é€šå ±ã™ã‚‹" : "é€ä¿¡ã™ã‚‹"}
                                    </Button>
                                </form>
                            </div>

                            <div className="md:col-span-1 border-l border-border pl-8 hidden md:block">
                                <h4 className="font-bold font-serif mb-6">ãŠé›»è©±ã§ã®ãŠå•ã„åˆã‚ã›</h4>
                                <p className="text-2xl font-eng mb-2">026-000-0000</p>
                                <p className="text-xs text-muted mb-8">å—ä»˜æ™‚é–“: 9:00 - 17:00 (åœŸæ—¥ç¥é™¤ã)</p>
                                
                                <h4 className="font-bold font-serif mb-4">ã‚ˆãã‚ã‚‹ã”è³ªå•</h4>
                                <ul className="text-sm text-muted space-y-3">
                                    <li className="hover:text-primary cursor-pointer">ãƒ» äºˆç´„ã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã«ã¤ã„ã¦</li>
                                    <li className="hover:text-primary cursor-pointer">ãƒ» ã‚®ãƒ•ãƒˆãƒ©ãƒƒãƒ”ãƒ³ã‚°ã«ã¤ã„ã¦</li>
                                    <li className="hover:text-primary cursor-pointer">ãƒ» ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼å¯¾å¿œã«ã¤ã„ã¦</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // --- Main App ---
        const App = () => {
            const [currentPage, setPage] = useState('home');
            const [phase, setPhase] = useState(1);
            const [flags, setFlags] = useState({});
            const [selectedStaff, setSelectedStaff] = useState(null);
            const [selectedArticle, setSelectedArticle] = useState(null);

            // ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆæ™‚ã«ãƒˆãƒƒãƒ—ã¸ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã™ã‚‹å‡¦ç†ã‚’è¿½åŠ 
            useEffect(() => {
                window.scrollTo(0, 0);
            }, [currentPage]);

            // Phase Logic (Simplified)
            useEffect(() => {
                const count = Object.keys(flags).length;
                let nextPhase = 1;
                if (count >= 3) nextPhase = 2;
                if (count >= 6) nextPhase = 3;
                if (count >= 9) nextPhase = 4;
                
                if (nextPhase > phase) setPhase(nextPhase);
            }, [flags, phase]);

            useEffect(() => {
                // Apply phase to body for CSS variables
                document.body.setAttribute('data-phase', phase);
            }, [phase]);

            useEffect(() => {
                // Lucide icons
                lucide.createIcons();
            }, [currentPage]);

            const unlockFlag = (flagId) => {
                if (!flags[flagId]) {
                    setFlags(prev => ({ ...prev, [flagId]: true }));
                }
            };

            const renderPage = () => {
                const props = { phase, unlockFlag, flags, setPage, setSelectedStaff, setSelectedArticle };
                switch(currentPage) {
                    case 'home': return <Home {...props} />;
                    case 'about': return <About {...props} />;
                    case 'staff_detail': return <StaffDetail staff={selectedStaff} setPage={setPage} unlockFlag={unlockFlag} flags={flags} />;
                    case 'village': return <Village {...props} />;
                    case 'products': return <Products {...props} />;
                    case 'diary': return <Diary {...props} />;
                    case 'article_detail': return <ArticleDetail article={selectedArticle} setPage={setPage} unlockFlag={unlockFlag} flags={flags} />;
                    case 'recipe': return <RecipeDetail setPage={setPage} unlockFlag={unlockFlag} flags={flags} />; // Recipe Route
                    case 'access': return <Access {...props} />;
                    case 'recruit': return <Recruit {...props} />;
                    case 'contact': return <Contact {...props} />;
                    default: return <Home {...props} />;
                }
            };

            return (
                <div className="min-h-screen flex flex-col font-sans text-text">
                    <Header setPage={setPage} currentPage={currentPage} phase={phase} />
                    <main className="flex-grow">
                        {renderPage()}
                    </main>
                    <Footer phase={phase} setPage={setPage} />

                    {/* Debug UI (Hidden in production concept, kept for testing) */}
                    <div className="fixed bottom-2 right-2 opacity-30 hover:opacity-100 z-[100] text-[10px] bg-black text-white p-2 rounded">
                        Phase: {phase} | Flags: {Object.keys(flags).length}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
